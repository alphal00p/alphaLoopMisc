(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    315261,       7567]
NotebookOptionsPosition[    293702,       7215]
NotebookOutlinePosition[    294099,       7231]
CellTagsIndexPosition[    294056,       7228]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Cross-Free Family LTD expression generator and tester", "Title",
 CellChangeTimes->{{3.872600790170209*^9, 3.872600806516221*^9}, {
  3.872796057703964*^9, 
  3.87279606917759*^9}},ExpressionUUID->"86275ee3-51a6-4326-9f3f-\
6d593e344f16"],

Cell[CellGroupData[{

Cell["Ressources", "Section",
 CellChangeTimes->{{3.872600809074922*^9, 
  3.872600816482483*^9}},ExpressionUUID->"ee43f195-2845-4b78-b518-\
3718626c817c"],

Cell[CellGroupData[{

Cell["Graph builders", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600830483729*^9}, {
  3.872745878206256*^9, 
  3.872745891590827*^9}},ExpressionUUID->"d9e6781f-66d7-4dac-9d89-\
13fc93dcac69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssignSignaturesStartingFromEdge", "[", 
   RowBox[{"g_Graph", ",", "startingVertex_", ",", "InputSignatures_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allIncomingEdges", ",", " ", "allOutgoingEdges", ",", 
      "otherVertexAndDirection", ",", "edgesWithoutSignature", ",", 
      "signatures"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"signatures", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k", "->", 
          RowBox[{"InputSignatures", "[", "k", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Keys", "[", "InputSignatures", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allIncomingEdges", "=", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"_", ",", "startingVertex", ",", "_"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"allOutgoingEdges", "=", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"startingVertex", ",", "_", ",", "_"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edgesWithoutSignature", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"allIncomingEdges", ",", "allOutgoingEdges"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "signatures", "]"}], ",", "#"}], "]"}], 
          "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "edgesWithoutSignature", "]"}], "==", "1"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"otherVertexAndDirection", "=", 
            RowBox[{"e", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"startingVertex", ",", "a_", ",", "_"}], "]"}], ":>", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "1"}], "}"}]}], ",", 
               RowBox[{
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"a_", ",", "startingVertex", ",", "_"}], "]"}], ":>", 
                RowBox[{"{", 
                 RowBox[{"a", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AssociateTo", "[", 
            RowBox[{"signatures", ",", 
             RowBox[{"e", "->", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "otherVertexAndDirection", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"signatures", "[", "eIN", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"eIN", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"allIncomingEdges", ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Keys", "[", "signatures", "]"}], ",", "#"}], 
                    "]"}], "&"}]}], "]"}]}], "}"}]}], "]"}], "]"}], 
                  "\[IndentingNewLine]", "-", 
                  RowBox[{"Total", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"signatures", "[", "eOUT", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"eOUT", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"allOutgoingEdges", ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Keys", "[", "signatures", "]"}], ",", "#"}], 
                    "]"}], "&"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
                 "\[IndentingNewLine]", ")"}]}], ")"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"signatures", "=", 
            RowBox[{"AssignSignaturesStartingFromEdge", "[", 
             RowBox[{"g", ",", 
              RowBox[{
              "otherVertexAndDirection", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", "signatures"}], "]"}]}], ";"}],
           "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", "edgesWithoutSignature"}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "signatures"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872650870965966*^9, 3.872650956574876*^9}, {
  3.87265188507577*^9, 3.872652153876686*^9}, {3.872652202435245*^9, 
  3.872652222288517*^9}, {3.872652330762204*^9, 3.872652505984066*^9}, {
  3.872652538389661*^9, 3.872652549895987*^9}, {3.8726526328941927`*^9, 
  3.872652771806941*^9}, {3.872652805799225*^9, 3.872652835938774*^9}, {
  3.8726528776962843`*^9, 3.872652969375751*^9}, {3.872679972505246*^9, 
  3.872679974535475*^9}, {3.872680072786425*^9, 3.8726800729647923`*^9}, {
  3.872680984722776*^9, 3.8726810051918077`*^9}, {3.872681202932508*^9, 
  3.872681351076365*^9}, {3.872681463063089*^9, 3.8726815279122763`*^9}, {
  3.872681566732953*^9, 3.872681577844483*^9}, {3.872692872736411*^9, 
  3.872692910403352*^9}, {3.8726929540556107`*^9, 3.872692967158003*^9}, {
  3.8726944769425097`*^9, 3.872694480760316*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5e3180d2-b40c-41e3-bc6c-dbd87624233b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetEdgeSignatures", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"lmb", "->", "Automatic"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "spanningTree", ",", "selectedLMB", ",", " ", "leaves", ",", "startEdge",
       ",", " ", "signatures", ",", "externalVertices", ",", "externalEdges", 
      ",", " ", "tmpA", ",", "leafEdge"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"externalVertices", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"VertexList", "[", "g", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"VertexDegree", "[", 
            RowBox[{"g", ",", "#"}], "]"}], "===", "1"}], "&"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "lmb", "]"}], "===", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spanningTree", "=", 
         RowBox[{"FindSpanningTree", "[", "g", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"selectedLMB", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Complement", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"EdgeList", "[", "g", "]"}], ",", "\[IndentingNewLine]", 
             
             RowBox[{"EdgeList", "[", "spanningTree", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"a_", ",", "b_", ",", "name_"}], "]"}], ":>", 
                "name"}], "}"}]}], ")"}], "&"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"spanningTree", "=", 
         RowBox[{"DirectedGraph", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "g", "]"}], ",", 
            RowBox[{
             RowBox[{"Not", "[", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "lmb", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{"#", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a_", ",", "b_", ",", "id_"}], "]"}], ":>", 
                    "id"}], "}"}]}], ")"}]}], "]"}], "]"}], "&"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"selectedLMB", "=", 
         RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"EdgeList", "[", "g", "]"}], ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "lmb", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{"#", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a_", ",", "b_", ",", "id_"}], "]"}], ":>", 
                    "id"}], "}"}]}], ")"}]}], "]"}], "&"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "lmb", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{"#", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a_", ",", "b_", ",", "id_"}], "]"}], ":>", 
                    "id"}], "}"}]}], ")"}]}], "]"}], "\[LeftDoubleBracket]", 
              "1", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "&"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assign", " ", "signatures", " ", "to", " ", "externals", " ", "now"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"signatures", "=", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tmpA", "=", 
           RowBox[{"EdgeList", "[", 
            RowBox[{"g", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{
               RowBox[{
               "externalVertices", "\[LeftDoubleBracket]", "iev", 
                "\[RightDoubleBracket]"}], ",", "_", ",", "_"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "It", " ", "is", " ", "much", " ", "simpler", " ", "if", " ", "we",
             " ", "force", " ", "all", " ", "externals", " ", "incoming", " ",
             "so", " ", "check", " ", "for", " ", "this", " ", "here"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "tmpA", "]"}], "!=", "1"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<ERROR: please define all externals as incoming in your \
topology.\>\"", "]"}], ";", 
             RowBox[{"Return", "[", "Null", "]"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmpA", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tmpA", "]"}], "==", "1"}], ",", 
             RowBox[{
             "tmpA", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"g", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"_", ",", 
                  RowBox[{
                  "externalVertices", "\[LeftDoubleBracket]", "iev", 
                   "\[RightDoubleBracket]"}], ",", "_"}], "]"}]}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmpA", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "selectedLMB", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"iev", "===", "j"}], ",", "1", ",", "0"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "externalVertices", "]"}]}], "}"}]}], 
              "]"}]}], "}"}]}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"iev", ",", 
           RowBox[{"Length", "[", "externalVertices", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"And", " ", "LMB", " ", "edges", " ", "now"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"signatures", "=", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"signatures", ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "selectedLMB", "\[LeftDoubleBracket]", "ie", 
            "\[RightDoubleBracket]"}], "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ie", "===", "j"}], ",", "1", ",", "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "selectedLMB", "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "externalVertices", "]"}]}], "}"}]}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ie", ",", 
            RowBox[{"Length", "[", "selectedLMB", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"And", " ", "all", " ", "others", " ", "now"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"leaves", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"VertexList", "[", "spanningTree", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"VertexDegree", "[", 
           RowBox[{"spanningTree", ",", "#"}], "]"}], "===", "1"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"leaves", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"leafEdge", "=", 
          RowBox[{"EdgeList", "[", 
           RowBox[{"spanningTree", ",", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"leaf", ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "leafEdge", "]"}], "==", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"leafEdge", "=", 
             RowBox[{
             "leafEdge", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "signatures", "]"}], ",", "leafEdge"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"leafEdge", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"_", ",", "x_", ",", "_"}], "]"}], ":>", "x"}], 
                "}"}]}], ",", "leaf"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"leafEdge", "=", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"spanningTree", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"_", ",", "leaf", ",", "_"}], "]"}]}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Keys", "[", "signatures", "]"}], ",", "leafEdge"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"leafEdge", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"x_", ",", "_", ",", "_"}], "]"}], ":>", "x"}], 
                "}"}]}], ",", "leaf"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"leaf", ",", "leaves"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"signatures", "=", 
         RowBox[{"AssignSignaturesStartingFromEdge", "[", 
          RowBox[{"g", ",", "leaf", ",", "signatures"}], "]"}]}], ";"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"leaf", ",", "leaves"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "signatures"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8726442820060997`*^9, 3.872644321406355*^9}, {
   3.8726445816079693`*^9, 3.872644585649467*^9}, {3.872644741527892*^9, 
   3.872644770675474*^9}, 3.87264481730588*^9, {3.872644933341609*^9, 
   3.872644934053999*^9}, {3.872644976772852*^9, 3.872644978043041*^9}, {
   3.87264855700298*^9, 3.872648582815555*^9}, {3.872648923718595*^9, 
   3.87264904090831*^9}, {3.872649078595607*^9, 3.872649078651173*^9}, {
   3.872649276921043*^9, 3.872649288137972*^9}, {3.87264932108286*^9, 
   3.8726493223334103`*^9}, {3.8726493579050417`*^9, 3.872649365842924*^9}, {
   3.8726494003847303`*^9, 3.872649420970498*^9}, {3.872649621991754*^9, 
   3.872649746938345*^9}, {3.872649804523858*^9, 3.8726500105918093`*^9}, {
   3.8726500575224457`*^9, 3.872650175450163*^9}, {3.872650229037807*^9, 
   3.8726502325440197`*^9}, {3.872650338298554*^9, 3.87265049925109*^9}, {
   3.8726506215914583`*^9, 3.872650622204719*^9}, {3.872650671709731*^9, 
   3.87265084665864*^9}, {3.872651893696302*^9, 3.872651893842911*^9}, {
   3.872652984272666*^9, 3.872653071994693*^9}, {3.872678350958737*^9, 
   3.872678409197468*^9}, {3.872679932476576*^9, 3.872679934479498*^9}, {
   3.872679966249695*^9, 3.87268022018427*^9}, {3.872680261984035*^9, 
   3.872680262616287*^9}, {3.8726803305229683`*^9, 3.872680568685951*^9}, {
   3.872681369314142*^9, 3.8726813694791727`*^9}, {3.872681618417025*^9, 
   3.8726816403970747`*^9}, 3.872693055396195*^9, 3.872694490700738*^9, {
   3.8727404137370653`*^9, 3.872740417571457*^9}, {3.872740466618396*^9, 
   3.872740543370612*^9}, {3.872743701692768*^9, 3.872743704159217*^9}, {
   3.872744508200021*^9, 3.872744661906802*^9}, {3.872744692263864*^9, 
   3.8727449056661263`*^9}, {3.872744937093443*^9, 3.872744943190112*^9}, {
   3.872745048523102*^9, 3.872745086606442*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"c02cd428-ff94-46cb-b4a8-72b7425ac0ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssignSignatures", "[", 
   RowBox[{"INg_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"masses", "->", "Null"}], ",", 
       RowBox[{"lmb", "->", "Automatic"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", "signatures"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "=", 
      RowBox[{"DirectedGraph", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"EdgeList", "[", "INg", "]"}], "\[LeftDoubleBracket]", 
           "ie", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], ":>", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"a", ",", "b", ",", "ie"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ie", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"EdgeList", "[", "INg", "]"}], "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"signatures", "=", " ", 
      RowBox[{"GetEdgeSignatures", "[", 
       RowBox[{"g", ",", 
        RowBox[{"lmb", "->", 
         RowBox[{"OptionValue", "[", "lmb", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DirectedGraph", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"e", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":>", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"a", ",", "b", ",", "\[IndentingNewLine]", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<id\>\"", "->", "c"}], ",", 
                RowBox[{"\"\<sig\>\"", "->", 
                 RowBox[{"signatures", "[", "e", "]"}]}], ",", 
                RowBox[{"\"\<mass\>\"", "->", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "masses", "]"}], "===", 
                    "Null"}], ",", "0", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Keys", "[", 
                    RowBox[{"OptionValue", "[", "masses", "]"}], "]"}], ",", 
                    "c"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "masses", "]"}], "[", "c", 
                    "]"}], ",", "0"}], "]"}]}], "]"}]}]}], "|>"}]}], 
             "\[IndentingNewLine]", "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", 
           RowBox[{"EdgeList", "[", "g", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"EdgeLabels", "\[Rule]", "None"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872734311286008*^9, 3.8727344161710443`*^9}, {
   3.872739501621354*^9, 3.872739598702408*^9}, {3.872739638604022*^9, 
   3.872739647584051*^9}, {3.872743458535427*^9, 3.8727434598827133`*^9}, {
   3.8727440608197727`*^9, 3.872744070404045*^9}, {3.872744120549384*^9, 
   3.872744122252241*^9}, {3.872744200832459*^9, 3.8727442211499033`*^9}, {
   3.872744308063992*^9, 3.872744431027412*^9}, {3.872744484761598*^9, 
   3.872744504138239*^9}, {3.872744980022107*^9, 3.87274498194268*^9}, 
   3.8727450169759903`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"044e38e6-e892-4255-8faf-f899242ea7e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateMomentaLabels", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "oneSig", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"oneSig", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"EdgeList", "[", "g", "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DirectedEdge", "[", 
            RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", "props"}], 
          "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<k\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "oneSig", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<p\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "oneSig", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872739773168405*^9, 3.87273997116544*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"f2f29f27-6b3f-489b-999c-ac2141fde43e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLMBEdges", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "lmbEdges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lmbEdges", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"EdgeList", "[", "g", "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"s", ",", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{
                 "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"si", ",", 
                   RowBox[{"si", "===", "0"}]}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}], "===", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "]"}], "-", "1"}]}], ",", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "1"}], "]"}], "===", "1"}]}], "]"}]}], "]"}], "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                 "props"}], "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], 
            ")"}]}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lmbEdges", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"lmbEdges", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                   "props"}], "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteDuplicatesBy", "[", 
      RowBox[{"lmbEdges", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", "props"}], 
            "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872742819754361*^9, 3.87274290180015*^9}, {
   3.872742936109687*^9, 3.872743014397303*^9}, {3.8727431796903143`*^9, 
   3.872743203888674*^9}, {3.872743236826666*^9, 3.872743269170443*^9}, 
   3.872743317369536*^9, {3.872743758824402*^9, 3.872743778183536*^9}, 
   3.872743815179543*^9, {3.8727438675370626`*^9, 3.8727438778554153`*^9}, {
   3.872789445231944*^9, 3.8727894495993423`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"8fc0f41c-220c-4f4d-a676-5cb01dadf168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetExternalEdges", "[", "g_Graph", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "externalEdges", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"externalEdges", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"EdgeList", "[", "g", "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"s", ",", 
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{
                 "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"si", ",", 
                   RowBox[{"si", "===", "0"}]}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "0"}], "]"}], "===", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "]"}], "-", "1"}]}], ",", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", "1"}], "]"}], "===", "1"}]}], "]"}]}], "]"}], "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                 "props"}], "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], 
            ")"}]}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"externalEdges", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{"externalEdges", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                   "props"}], "}"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872743657658819*^9, 3.8727436588638906`*^9}, {
  3.872743728805468*^9, 3.872743741058402*^9}, {3.872743887790135*^9, 
  3.872743914836919*^9}, {3.872789306686453*^9, 3.872789362307073*^9}, {
  3.872789440585125*^9, 3.872789468364016*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"efa2ea67-9a7a-46f0-b396-e9673921f7de"]
}, Closed]],

Cell[CellGroupData[{

Cell["cFF Generator", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600830483729*^9}, {
  3.872745878206256*^9, 
  3.872745879051979*^9}},ExpressionUUID->"b547e410-9e2c-4456-861f-\
d45fbf921924"],

Cell["Amazingly, EdgeContract is bugged, i.e see:", "Text",
 CellChangeTimes->{{3.8727924549829693`*^9, 
  3.872792464733859*^9}},ExpressionUUID->"1c3cef45-cff7-4d8d-9a51-\
8daf2400706d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EdgeContract", "[", 
  RowBox[{
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "4", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DirectedEdge", "[", 
    RowBox[{"1", ",", "2", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8727925176037416`*^9, 3.8727925270194197`*^9}, {
  3.8727964786966543`*^9, 3.872796480844285*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"9b293a60-a18c-4749-a827-6648df9d9bdd"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{3, 4, 1}, {{{1, 2}, {3, 1}, {2, 3}}, Null, {3, 1, 4}}, {
      EdgeLabels -> {Automatic}, GraphLayout -> {"Dimension" -> 2}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
          0.8660254037844389, -0.5000000000000012}}, 0.020399597244776385`], 
         InsetBox["3", {2.7755575615628914*^-16, -0.5000000000000003}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
          1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], 
         InsetBox["4", {0.4330127018922196, 0.2499999999999994}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1.8369701987210297`*^-16, 
          1.}, {-0.8660254037844384, -0.4999999999999994}}, 
          0.020399597244776385`], 
         InsetBox["1", {-0.4330127018922191, 0.25000000000000033}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
          0.020399597244776385], 
         InsetBox["3", 
          Offset[{2, 2}, {-0.845625806539662, -0.479600402755223}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844389, -0.5000000000000012}, 
          0.020399597244776385], 
         InsetBox["4", 
          Offset[{2, 2}, {0.8864250010292153, -0.47960040275522486}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385], 
         InsetBox["1", 
          Offset[{2, 2}, {0.02039959724477657, 1.0203995972447764}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.872792527387081*^9, 3.8727926125595627`*^9, 
  3.872796481448907*^9},
 CellLabel->
  "Out[499]=",ExpressionUUID->"658ed01b-2281-44e1-9aab-85f81c7cced8"]
}, Open  ]],

Cell["Therefore we\[CloseCurlyQuote]ll use the hand-crafted version below:", \
"Text",
 CellChangeTimes->{{3.872792476935549*^9, 
  3.872792489066764*^9}},ExpressionUUID->"8dab4ed5-9c54-4b63-82c2-\
30b396990e47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BugFixedEdgeContract", "[", 
   RowBox[{"g_Graph", ",", "edgeToContract_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nodeToMap", ",", "newEdges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodeToMap", "=", 
      RowBox[{"(", 
       RowBox[{"edgeToContract", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DirectedEdge", "[", 
           RowBox[{"a_", ",", "b_", ",", "_"}], "]"}], ":>", 
          RowBox[{"{", 
           RowBox[{"a", "->", "b"}], "}"}]}], "}"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newEdges", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"e", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DirectedEdge", "[", 
            RowBox[{"a_", ",", "b_", ",", "props_"}], "]"}], ":>", 
           RowBox[{"DirectedEdge", "[", 
            RowBox[{
             RowBox[{"a", "/.", "nodeToMap"}], ",", 
             RowBox[{"b", "/.", "nodeToMap"}], ",", "props"}], "]"}]}], 
          "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "g", "]"}], ",", "edgeToContract"}], 
           "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Remove", " ", "self"}], "-", 
       RowBox[{"loops", " ", "too", " ", "here"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newEdges", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"newEdges", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"a_", ",", "b_", ",", "_"}], "]"}], ":>", 
            RowBox[{"a", "!=", "b"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DirectedGraph", "[", "newEdges", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872791868647874*^9, 3.872792015611043*^9}, {
   3.87279206779959*^9, 3.872792230090517*^9}, {3.872792293441835*^9, 
   3.872792327117244*^9}, 3.872792387671155*^9, {3.872796271078103*^9, 
   3.872796459045187*^9}, {3.872826467611274*^9, 3.872826469761718*^9}, {
   3.872838360584654*^9, 3.8728383630174723`*^9}},
 CellLabel->
  "In[743]:=",ExpressionUUID->"5e8905ba-e0ba-4f61-a99a-92946633d8aa"],

Cell["which is not bugged... see:", "Text",
 CellChangeTimes->{{3.872792493085609*^9, 3.872792499060235*^9}, {
  3.872792535487762*^9, 
  3.872792536132289*^9}},ExpressionUUID->"8a7814c2-e3f7-4f67-bb3b-\
8df187f51caa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DirectedGraph", "[", 
  RowBox[{
   RowBox[{"BugFixedEdgeContract", "[", 
    RowBox[{
     RowBox[{"DirectedGraph", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DirectedEdge", "[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
         RowBox[{"DirectedEdge", "[", 
          RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DirectedEdge", "[", 
          RowBox[{"3", ",", "4", ",", "3"}], "]"}], ",", 
         RowBox[{"DirectedEdge", "[", 
          RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"1", ",", "2", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.872792540652813*^9, 3.87279256822258*^9}, {
  3.8727964717962093`*^9, 3.872796473927326*^9}},
 CellLabel->
  "In[692]:=",ExpressionUUID->"dad85e1c-c656-423a-96e8-581280783a74"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{2, 3, 4}, {{{1, 2}, {2, 3}, {3, 1}}, Null, {2, 3, 4}}, {
      EdgeLabels -> {Automatic}, VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
          0.8660254037844389, -0.5000000000000012}}, 0.020399597244776385`], 
         InsetBox["2", {2.7755575615628914*^-16, -0.5000000000000003}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
          1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], 
         InsetBox["3", {0.4330127018922196, 0.2499999999999994}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1.8369701987210297`*^-16, 
          1.}, {-0.8660254037844384, -0.4999999999999994}}, 
          0.020399597244776385`], 
         InsetBox["4", {-0.4330127018922191, 0.25000000000000033}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
          0.020399597244776385], 
         InsetBox["2", 
          Offset[{2, 2}, {-0.845625806539662, -0.479600402755223}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844389, -0.5000000000000012}, 
          0.020399597244776385], 
         InsetBox["3", 
          Offset[{2, 2}, {0.8864250010292153, -0.47960040275522486}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385], 
         InsetBox["4", 
          Offset[{2, 2}, {0.02039959724477657, 1.0203995972447764}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.87279254484461*^9, 3.8727925688470087`*^9}, 
   3.872792612674275*^9, 3.87279642092558*^9, {3.872796462631916*^9, 
   3.8727964750639877`*^9}, 3.8728384752259493`*^9},
 CellLabel->
  "Out[692]=",ExpressionUUID->"c1f3161b-f9cb-4f2a-81a4-a9986cd34309"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GraphContributeToCFFQ", "[", "g_Graph", "]"}], ":=", 
    RowBox[{"And", "[", 
     RowBox[{
      RowBox[{"AcyclicGraphQ", "[", "g", "]"}], ",", 
      RowBox[{"LoopFreeGraphQ", "[", "g", "]"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphContributeToCFFQ", "[", "g_Graph", "]"}], ":=", 
   RowBox[{"AcyclicGraphQ", "[", "g", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.872795845915208*^9, 3.872795886819347*^9}, {
  3.872796210925847*^9, 3.87279621266991*^9}, {3.872826404010768*^9, 
  3.8728264102925587`*^9}, {3.872838380728112*^9, 3.872838401734672*^9}, {
  3.872840621134994*^9, 3.872840627734708*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"49b15741-31cb-482b-a0e7-77aad16b3b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EnumerateAcyclicOrientations", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"Orientations", "->", "Automatic"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"el", ",", "allOrientations"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"el", "=", 
      RowBox[{"EdgeList", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allOrientations", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"DirectedGraph", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "o", "\[LeftDoubleBracket]", "iE", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                   RowBox[{
                   "el", "\[LeftDoubleBracket]", "iE", 
                    "\[RightDoubleBracket]"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a_", ",", "b_", ",", "name_"}], "]"}], ":>", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"b", ",", "a", ",", "name"}], "]"}]}], "}"}]}], 
                  ",", 
                  RowBox[{
                  "el", "\[LeftDoubleBracket]", "iE", 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"iE", ",", 
                  RowBox[{"Length", "[", "el", "]"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
              RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", 
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"True", ",", "False"}], "}"}], ",", 
              RowBox[{"Length", "[", "el", "]"}]}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"GraphContributeToCFFQ", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "Orientations", "]"}], "===", 
        "Automatic"}], ",", "allOrientations", ",", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", 
        RowBox[{"allOrientations", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Orientations", "]"}], ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.872594692051852*^9, 3.8725946920560293`*^9}, {
   3.8725948049335957`*^9, 3.872594826695578*^9}, {3.8725950696029663`*^9, 
   3.872595282629074*^9}, {3.872595525586875*^9, 3.872595546183515*^9}, {
   3.8725966586147833`*^9, 3.8725966614363422`*^9}, 3.872596716186048*^9, {
   3.872596849561183*^9, 3.872596875824891*^9}, {3.8725969173675528`*^9, 
   3.872596926289266*^9}, {3.872599951914366*^9, 3.872599996873513*^9}, 
   3.872795904369484*^9, {3.872823598245275*^9, 3.872823684854754*^9}},
 CellLabel->
  "In[746]:=",ExpressionUUID->"9a7721cf-b407-4028-a561-705a1d3b3e7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossFreeFamilyReduce", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ConvertToNormalisedFormat", "->", "False"}], ",", 
       RowBox[{"DEBUG", "->", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sources", ",", "allEdgesToDelete", ",", "allTerms", ",", "Esurf", ",", 
      "allContractedGraphs"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"Table", "[", 
           RowBox[{"\"\<-\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Range", "[", "60", "]"}]}], "}"}]}], "]"}], "]"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<Now considering the following graph:\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"DirectedGraph", "[", 
          RowBox[{"g", ",", 
           RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"EdgeLabels", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"e", "->", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"e", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                    "props"}], "}"}]}], ")"}], "[", "\"\<id\>\"", "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"EdgeList", "[", "g", "]"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "g", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "g", "]"}], "]"}], "==", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esurf", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"e", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"a_", ",", "b_", ",", "name_"}], "]"}], ":>", 
              RowBox[{"name", "[", "\"\<id\>\"", "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"e", ",", 
             RowBox[{"EdgeList", "[", "g", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Reached termination condition, returning Esurf:\>\"", ",", 
             "Esurf"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "ConvertToNormalisedFormat", "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"{", "Esurf", "}"}], "}"}], "]"}], ";"}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"1", "/", 
             RowBox[{"Total", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"OSE", "[", "name", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"name", ",", "Esurf"}], "}"}]}], "]"}], "]"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sources", "=", 
      RowBox[{"GraphComputation`SourceVertexList", "[", "g", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Found the following sources (first one will be considered): \
\>\"", ",", "sources"}], "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "sources", "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "g", "]"}], ";"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"sources", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allEdgesToDelete", "=", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{
          RowBox[{
          "sources", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "_", ",", "_"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"allContractedGraphs", "=", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"edgeToDelete", ",", 
            RowBox[{"BugFixedEdgeContract", "[", 
             RowBox[{"g", ",", "edgeToDelete"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"edgeToDelete", ",", "allEdgesToDelete"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"GraphContributeToCFFQ", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allContractedGraphs", "=", 
      RowBox[{"DeleteDuplicatesBy", "[", 
       RowBox[{"allContractedGraphs", ",", 
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Edges to be contracted (possibly won't contribute all): \>\"", 
          ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e", "/.", 
               RowBox[{"{", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"a_", ",", "b_", ",", "props_"}], "]"}], ":>", 
                  "props"}], ")"}], "}"}]}], ")"}], "[", "\"\<id\>\"", "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", "allEdgesToDelete"}], "}"}]}], "]"}]}], "]"}], 
        ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Contributing edge contractions: \>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
            "eInfo", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"eInfo", ",", "allContractedGraphs"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "allEdgesToDelete", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Esurf", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"e", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"DirectedEdge", "[", 
            RowBox[{"a_", ",", "b_", ",", "name_"}], "]"}], ":>", 
           RowBox[{"name", "[", "\"\<id\>\"", "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "allEdgesToDelete"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Esurf for this term: \>\"", ",", "Esurf"}], "]"}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"OptionValue", "[", "ConvertToNormalisedFormat", "]"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Esurf", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"OSE", "[", "name", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"name", ",", "Esurf"}], "}"}]}], "]"}], "]"}]}], ";"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"allTerms", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CrossFreeFamilyReduce", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"ConvertToNormalisedFormat", "->", 
             RowBox[{"OptionValue", "[", "ConvertToNormalisedFormat", "]"}]}],
             ",", 
            RowBox[{"DEBUG", "->", 
             RowBox[{"OptionValue", "[", "DEBUG", "]"}]}]}], "]"}], ")"}], 
         "&"}], ")"}], "/@", "allContractedGraphs"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"OptionValue", "[", "ConvertToNormalisedFormat", "]"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Complete term returned at this level: \>\"", ",", 
             RowBox[{
              FractionBox["1", "Esurf"], 
              RowBox[{"Total", "[", "allTerms", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"Table", "[", 
              RowBox[{"\"\<-\>\"", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Range", "[", "60", "]"}]}], "}"}]}], "]"}], "]"}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["1", "Esurf"], 
         RowBox[{"Total", "[", "allTerms", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"ti", ",", "Esurf"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ti", ",", "t"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "allTerms"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872595579752014*^9, 3.872595650527466*^9}, {
   3.872595728540979*^9, 3.87259577581391*^9}, {3.872595891376223*^9, 
   3.8725959268115683`*^9}, {3.872595967833263*^9, 3.8725960038666143`*^9}, {
   3.872597083497497*^9, 3.8725971413117857`*^9}, 3.8725971801413383`*^9, {
   3.872597248943088*^9, 3.8725973608877077`*^9}, {3.872597414405702*^9, 
   3.872597535489749*^9}, {3.872598469881124*^9, 3.8725984991362247`*^9}, {
   3.872600097634688*^9, 3.87260014315844*^9}, {3.8726002262095137`*^9, 
   3.872600233839374*^9}, {3.872600484014336*^9, 3.8726005153021603`*^9}, {
   3.872600546456334*^9, 3.872600556218856*^9}, 3.872601475431404*^9, {
   3.8726016913047028`*^9, 3.872602134913621*^9}, {3.872602166529539*^9, 
   3.872602239089877*^9}, {3.872602319670895*^9, 3.872602320982407*^9}, {
   3.8726026068704443`*^9, 3.872602608722376*^9}, {3.872604574429295*^9, 
   3.8726045762540083`*^9}, {3.872604617360347*^9, 3.872604625820857*^9}, {
   3.8726046625662727`*^9, 3.872604665320197*^9}, {3.872604783287109*^9, 
   3.8726047889877863`*^9}, {3.872604877234015*^9, 3.87260488787241*^9}, {
   3.8726050316904707`*^9, 3.872605058549025*^9}, {3.872605108515114*^9, 
   3.8726051089110126`*^9}, {3.8726051838178883`*^9, 3.872605185632955*^9}, {
   3.872605243314084*^9, 3.872605245018395*^9}, {3.872605337678288*^9, 
   3.87260534364545*^9}, {3.872786528726022*^9, 3.872786545553637*^9}, {
   3.872786755349078*^9, 3.872786757980671*^9}, 3.8727925871613083`*^9, {
   3.872795291813908*^9, 3.8727953104913282`*^9}, {3.872795907721429*^9, 
   3.8727959237667017`*^9}, {3.872823455695198*^9, 3.872823460585679*^9}, {
   3.872823717119061*^9, 3.872823739368928*^9}, {3.8728237854344177`*^9, 
   3.872823911631905*^9}, {3.872823962934225*^9, 3.872824027848822*^9}, {
   3.872824059608033*^9, 3.8728240814262953`*^9}, {3.872824129041355*^9, 
   3.872824167850663*^9}, {3.872824288968351*^9, 3.872824293248605*^9}, {
   3.872824436493291*^9, 3.8728244423459883`*^9}, {3.872824498923955*^9, 
   3.8728245047103786`*^9}, {3.8728245614599743`*^9, 3.872824562641284*^9}, {
   3.872824618710353*^9, 3.872824619492944*^9}, {3.87282483373022*^9, 
   3.872825054351756*^9}, {3.872825092130423*^9, 3.872825109742456*^9}, 
   3.872825143987053*^9, {3.872825184823838*^9, 3.872825224971744*^9}, {
   3.8728252586901503`*^9, 3.872825270179229*^9}, {3.872825394824071*^9, 
   3.872825455348596*^9}, {3.872825828145988*^9, 3.87282584511465*^9}, {
   3.872840028143605*^9, 3.872840056263091*^9}, {3.87284008898207*^9, 
   3.872840099542417*^9}, {3.872840210538105*^9, 3.872840257434428*^9}, {
   3.872840289128911*^9, 3.872840307058846*^9}, {3.8728405666041813`*^9, 
   3.872840578646571*^9}, {3.872840647860601*^9, 3.872840681571206*^9}},
 CellLabel->
  "In[749]:=",ExpressionUUID->"d7d5c4fa-906b-490b-9304-de4c4eb82c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateEnergyShiftSignatureForEsurf", "[", 
   RowBox[{"g_Graph", ",", "edgeCuts_", ",", "flipConfiguration_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "edgesCut", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edgesCut", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"EdgeList", "[", "g", "]"}], ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"edgeCuts", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
               "props"}]}], ")"}], "[", "\"\<id\>\"", "]"}]}], "]"}], "&"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"-", 
      RowBox[{"Total", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"flipConfiguration", "[", "e", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"e", "/.", 
               RowBox[{
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                "props"}]}], ")"}], "[", "\"\<sig\>\"", "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ")"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "edgesCut"}], "}"}]}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872790849801441*^9, 3.872790897103722*^9}, {
   3.872791143880025*^9, 3.872791145064559*^9}, {3.8727911820193167`*^9, 
   3.872791323744671*^9}, {3.872794621334511*^9, 3.872794638613091*^9}, {
   3.872794715315544*^9, 3.8727947257304173`*^9}, 3.872795002806903*^9, 
   3.8727951318232307`*^9, 3.87279517973983*^9, 3.8727979897472563`*^9},
 CellLabel->
  "In[656]:=",ExpressionUUID->"2afffa21-7eff-4618-bcec-8671174e89fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossFreeFamilyLTD", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ConvertToNormalisedFormat", "->", "False"}], ",", 
       RowBox[{"DEBUG", "->", "False"}], ",", 
       RowBox[{"Orientations", "->", "Automatic"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allTerms", ",", "reducedGraph", ",", " ", "flipConfiguration", ",", 
      "allOrientations"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "act", " ", "on", " ", "the", " ", "reduced", " ", "graph", " ", 
      "stripped", " ", "off", " ", "external", " ", "for", " ", "now"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reducedGraph", "=", 
      RowBox[{"GraphDifference", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedGraph", "[", 
         RowBox[{"GetExternalEdges", "[", "g", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allOrientations", "=", 
      RowBox[{"EnumerateAcyclicOrientations", "[", 
       RowBox[{"reducedGraph", ",", 
        RowBox[{"Orientations", "->", 
         RowBox[{"OptionValue", "[", "Orientations", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"allTerms", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "allOrientations", "\[LeftDoubleBracket]", "iacg", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<Now considering orientation: \>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"o", ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"o", ",", 
                    RowBox[{
                    RowBox[{
                    "allOrientations", "\[LeftDoubleBracket]", "iacg", 
                    "\[RightDoubleBracket]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"CrossFreeFamilyReduce", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "allOrientations", "\[LeftDoubleBracket]", "iacg", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"ConvertToNormalisedFormat", "->", 
                 RowBox[{
                 "OptionValue", "[", "ConvertToNormalisedFormat", "]"}]}], 
                ",", 
                RowBox[{"DEBUG", "->", 
                 RowBox[{"OptionValue", "[", "DEBUG", "]"}]}]}], 
               "\[IndentingNewLine]", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"iacg", ",", 
             RowBox[{"Length", "[", "allOrientations", "]"}]}], "}"}]}], 
          "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", 
        RowBox[{"\"\<Evaluating orientation #\>\"", "<>", 
         RowBox[{"ToString", "[", "iacg", "]"}], "<>", "\"\</\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "allOrientations", "]"}], "]"}], "<>", 
         "\"\< (\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"100.", 
             RowBox[{"(", 
              FractionBox["iacg", 
               RowBox[{"Length", "[", "allOrientations", "]"}]], ")"}]}], ",",
             "0.01"}], "]"}], "]"}], "<>", "\"\<%)\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"OptionValue", "[", "ConvertToNormalisedFormat", "]"}], "]"}],
        ",", "\[IndentingNewLine]", "allTerms", ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"flipConfiguration", "=", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "iE", 
                   "\[RightDoubleBracket]"}], "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "o", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "iE", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iE", ",", 
                   RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}],
               ")"}], "@", 
             RowBox[{"EdgeList", "[", "reducedGraph", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"<|", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<Orientation\>\"", "->", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"isFlipped", ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"isFlipped", ",", 
                 RowBox[{
                 "o", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Terms\>\"", "->", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"<|", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\"\<Num\>\"", "->", 
                  RowBox[{"(", "1", ")"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<Orderings\>\"", "->", "Null"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\"\<Esurfs\>\"", "->", 
                  RowBox[{"Table", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"<|", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<OSE\>\"", "->", "ti"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<shift_signature\>\"", "->", 
                    RowBox[{"GenerateEnergyShiftSignatureForEsurf", "[", 
                    RowBox[{"g", ",", "ti", ",", "flipConfiguration"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "|>"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"ti", ",", "t"}], "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "|>"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{
                 "o", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"o", ",", "allTerms"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.872594370267555*^9, 3.872594381650317*^9}, {
   3.872594720027855*^9, 3.872594720737089*^9}, {3.872595412922948*^9, 
   3.872595509450015*^9}, {3.87259555568118*^9, 3.8725955657771797`*^9}, {
   3.8726000798909693`*^9, 3.872600085086587*^9}, 3.872600538370709*^9, {
   3.8726011394895563`*^9, 3.872601396464176*^9}, {3.872601451285516*^9, 
   3.87260146067844*^9}, {3.872602357705655*^9, 3.872602408529923*^9}, {
   3.872604801780642*^9, 3.8726048230125227`*^9}, {3.872605138690125*^9, 
   3.872605140551581*^9}, {3.872605294448069*^9, 3.872605327105157*^9}, {
   3.8726065692551327`*^9, 3.872606582394305*^9}, 3.87264195352134*^9, {
   3.872786816082999*^9, 3.872786894962163*^9}, 3.872786925646152*^9, {
   3.8727877441787367`*^9, 3.872787744327251*^9}, {3.8727910462514343`*^9, 
   3.8727910496499443`*^9}, {3.8727911522345543`*^9, 3.872791162625866*^9}, {
   3.872794438522832*^9, 3.87279447401455*^9}, {3.872794513045232*^9, 
   3.872794599130925*^9}, {3.872794693957345*^9, 3.872794703263186*^9}, {
   3.87279486952098*^9, 3.8727948748666563`*^9}, {3.872823399395462*^9, 
   3.8728234239106817`*^9}, {3.87282349121066*^9, 3.872823494462421*^9}, {
   3.872823536579858*^9, 3.872823581068515*^9}, {3.8728243274864817`*^9, 
   3.872824399197701*^9}, {3.872849642855761*^9, 3.8728497960667667`*^9}, {
   3.872849858140629*^9, 3.872849910006916*^9}},
 CellLabel->
  "In[887]:=",ExpressionUUID->"f1131458-1a5c-4f05-b377-0ef70b087482"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluators", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600830483729*^9}, {
  3.872605438934588*^9, 
  3.872605444806723*^9}},ExpressionUUID->"1b7bf3ee-c334-4f4a-8d79-\
ded55f8a87ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountOPs", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "leaves", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"leaves", "=", 
      RowBox[{"Level", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"Heads", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Tally", "[", "leaves", "]"}], ",", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Times", ",", "Power", ",", "Plus"}], "}"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8728410255582952`*^9, 3.872841102680204*^9}},
 CellLabel->
  "In[795]:=",ExpressionUUID->"f42c563d-c88c-4337-8304-2aa82e081d5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"Seed", "->", "Automatic"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"momLabels", ",", "RNSeed", ",", "RN", ",", "NumericalSample"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momLabels", "=", 
      RowBox[{"GenerateMomentaLabels", "[", "g", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RNSeed", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "Seed", "]"}], "===", "Automatic"}], ",", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}], "]"}], ",", 
        RowBox[{"OptionValue", "[", "Seed", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RN", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Prime", "[", "i", "]"}], "/", 
         RowBox[{"Prime", "[", 
          RowBox[{"i", "+", "1"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "RNSeed", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                 "momLabels", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "+", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "-", "1"}], ",", "0"}], 
                 "]"}]}], ")"}]}], "+", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                 "momLabels", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "]"}], "-", "1"}], ",", "0"}], 
              "]"}]}], ")"}], "+", "RNSeed", "-", "1"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"NumericalSample", "=", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "momLabels", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
            RowBox[{"ki", "+", "1"}], "\[RightDoubleBracket]"}], "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RN", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"ki", "*", "3"}], "+", "j"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ki", ",", "0", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "momLabels", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "momLabels", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "]"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "momLabels", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                RowBox[{"pi", "+", "1"}], "\[RightDoubleBracket]"}], "->", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"RN", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", "pi"}], ")"}], "*",
                     "3"}], "+", "j"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"pi", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "momLabels", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}], "-", "2"}]}], "}"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToExpression", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{
                   "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "pi", 
                   "\[RightDoubleBracket]"}], "]"}], "<>", "\"\<E\>\""}], 
                "]"}], "->", 
               RowBox[{"RN", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "-", "1"}], ")"}], "*", 
                  "3"}], "+", "pi"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"pi", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "momLabels", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}], "-", "1"}]}], "}"}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{
         "momLabels", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NumericalSample", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"NumericalSample", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "momLabels", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "->", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                   "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                   RowBox[{";;", 
                    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
                "/.", "NumericalSample"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{
                  RowBox[{
                  "momLabels", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], "<>", 
                "\"\<E\>\""}], "]"}], "->", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Total", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"ToExpression", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "pi", "]"}], "<>", "\"\<E\>\""}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"pi", ",", 
                    RowBox[{
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}], "]"}]}], "/.", "NumericalSample"}], 
               "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "momLabels", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NumericalSample", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"NumericalSample", ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "momLabels", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "->", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{
                    "momLabels", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                   "<>", "\"\<E\>\""}], "]"}], "->", "0"}]}], 
               "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "NumericalSample"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.872740316352803*^9, 3.8727403210636587`*^9}, {
  3.8727405541049757`*^9, 3.872740743511147*^9}, {3.872740780381302*^9, 
  3.8727409315738287`*^9}, {3.872741206067083*^9, 3.8727412169145184`*^9}, {
  3.87274219966538*^9, 3.872742552139626*^9}, {3.872746145360145*^9, 
  3.872746150457822*^9}, {3.872746201833808*^9, 3.87274642462365*^9}, {
  3.87274646662368*^9, 3.872746496571259*^9}, {3.872785971982462*^9, 
  3.872785977283341*^9}, {3.872786035733903*^9, 3.872786073644175*^9}, {
  3.872789883965623*^9, 3.8727898879484777`*^9}, {3.872792946105279*^9, 
  3.872792946472335*^9}, {3.872792987914654*^9, 3.8727929973942127`*^9}, {
  3.872793062280493*^9, 3.8727930650675488`*^9}, {3.8727941019822474`*^9, 
  3.8727941023178062`*^9}},
 CellLabel->
  "In[404]:=",ExpressionUUID->"675c1819-b02a-48b1-8c82-d56c04a3b187"],

Cell[CellGroupData[{

Cell["cLTD", "Subsubsection",
 CellChangeTimes->{{3.872605487382251*^9, 
  3.872605499746788*^9}},ExpressionUUID->"6036fe86-de95-4e7d-9eea-\
fb994010867b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "cLTDPATH", "=", "\"\</Users/vjhirsch/HEP_programs/cLTD/cLTD.m\>\""}], 
   ";"}], 
  RowBox[{"(*", "\"\<<PASTE_HERE_YOUR_CLTD_PATH>\>\"", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "FORMPATH", "=", "\"\</Users/vjhirsch/HEP_programs/form/bin/form\>\""}], 
   ";"}], 
  RowBox[{"(*", "\"\<<PASTE_HERE_YOUR_FORM_PATH>\>\"", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Get", "[", "cLTDPATH", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.87270982672668*^9, 3.872709861675187*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"8ee3a4e9-3281-4870-bc18-df1221206d2e"],

Cell[CellGroupData[{

Cell[BoxData["\<\" :::::::::::::::::::::::: cLTD \
::::::::::::::::::::::::\"\>"], "Print",
 CellChangeTimes->{3.872709864083366*^9, 3.872745846735237*^9, 
  3.872745946052018*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"28aae435-6bc1-4674-941f-d5c56ea9799d"],

Cell[BoxData["\<\"Authors: Z. Capatti, V. Hirschi, D. Kermanschah, A. \
Pelloni, B. Ruijl\"\>"], "Print",
 CellChangeTimes->{3.872709864083366*^9, 3.872745846735237*^9, 
  3.872745946055578*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"c8f381a9-cd44-46bb-ac7b-3162c39350d6"],

Cell[BoxData["\<\"\\tA Mathematica front end for cLTD \
[arxiv:2009.05509].\\n\"\>"], "Print",
 CellChangeTimes->{3.872709864083366*^9, 3.872745846735237*^9, 
  3.872745946059368*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"05a17ff0-c733-4f96-8be4-e98170a45efa"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneratecLTDExpression", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"Num", "->", "None"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "props", ",", "momLabels", ",", "num", ",", "cLTDExpr", ",", 
      "reducedGraph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momLabels", "=", 
      RowBox[{"GenerateMomentaLabels", "[", "g", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "Num", "]"}], "===", "None"}], ",", "1", 
        ",", 
        RowBox[{"OptionValue", "[", "Num", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reducedGraph", "=", 
      RowBox[{"GraphDifference", "[", 
       RowBox[{"g", ",", 
        RowBox[{"DirectedGraph", "[", 
         RowBox[{"GetExternalEdges", "[", "g", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"props", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"prop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<sig\>\"", "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
               RowBox[{
               "momLabels", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<sig\>\"", "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ".", 
               RowBox[{
               "momLabels", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}], ",", 
             RowBox[{"#", "[", "\"\<mass\>\"", "]"}]}], "]"}], "&"}], ")"}], 
         "@", 
         RowBox[{"(", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", "props"}], 
            "}"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", 
          RowBox[{"EdgeList", "[", "reducedGraph", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cLTDExpr", " ", "=", " ", 
      RowBox[{"cLTD", "[", 
       RowBox[{
        RowBox[{"num", " ", 
         RowBox[{"Times", "@@", " ", "props"}]}], ",", " ", 
        RowBox[{"NoNumerator", " ", "->", " ", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Num", "]"}], "===", "None"}]}], ",", 
        " ", 
        RowBox[{"loopmom", " ", "->", " ", 
         RowBox[{
         "momLabels", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ",", " ", 
        RowBox[{"EvalAll", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"\"\<FORMpath\>\"", " ", "->", " ", "FORMPATH"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"cLTDExpr", "=", 
      RowBox[{"cLTDExpr", "/.", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "0", "]"}], "->", 
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "pi", "]"}], "<>", "\"\<E\>\""}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"pi", ",", 
           RowBox[{
           "momLabels", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "cLTDExpr"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.872739470243477*^9, 3.872739494034203*^9}, {
   3.872739693518128*^9, 3.872739759469964*^9}, {3.872739979115377*^9, 
   3.872740275815504*^9}, {3.872742591359215*^9, 3.872742722705638*^9}, {
   3.872745829609208*^9, 3.8727458339087667`*^9}, {3.872745965090613*^9, 
   3.872746010496586*^9}, {3.8727900152785254`*^9, 3.87279002022515*^9}, {
   3.872790055895969*^9, 3.8727900873316393`*^9}, 3.872790142263193*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"2e97743c-c644-4685-a7b7-a591424bb0ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EvalcLTD", "[", 
   RowBox[{"cLTDexpr_", ",", "numerics_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"cLTDexpr", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cLTDexpr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", "numerics"}], ")"}]}], "/.", 
   "numerics"}]}]], "Input",
 CellChangeTimes->{{3.872786109068252*^9, 3.8727861679614763`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"3ede01d6-4b7f-4af1-9434-a851b5a5b538"]
}, Closed]],

Cell[CellGroupData[{

Cell["cFF", "Subsubsection",
 CellChangeTimes->{{3.872605487382251*^9, 
  3.872605515010832*^9}},ExpressionUUID->"7ac64cef-cc72-40c3-b48c-\
68e35887e6a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeOSEReplacements", "[", 
   RowBox[{"g_Graph", ",", "numerics_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momLabels", ",", "ks", ",", "ps", ",", "edgeProperties", ",", 
      "OSRepl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momLabels", "=", 
      RowBox[{"GenerateMomentaLabels", "[", "g", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ks", "=", 
      RowBox[{
      "momLabels", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ps", "=", 
      RowBox[{
      "momLabels", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"OSRepl", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeProperties", "=", 
          RowBox[{"(", 
           RowBox[{"e", "/.", 
            RowBox[{
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
             "props"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OSE", "[", 
           RowBox[{"edgeProperties", "[", "\"\<id\>\"", "]"}], "]"}], ":>", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeProperties", "[", "\"\<sig\>\"", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ".", "ks"}], "+", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeProperties", "[", "\"\<sig\>\"", "]"}], 
                   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  ".", "ps"}]}], ")"}], ".", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeProperties", "[", "\"\<sig\>\"", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ".", "ks"}], "+", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeProperties", "[", "\"\<sig\>\"", "]"}], 
                   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  ".", "ps"}]}], ")"}]}], "+", 
              SuperscriptBox[
               RowBox[{"edgeProperties", "[", "\"\<mass\>\"", "]"}], "2"]}], 
             "\[IndentingNewLine]", "]"}], "/.", "numerics"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", 
          RowBox[{"EdgeList", "[", "g", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "OSRepl"}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.872605767529451*^9, 3.872605784539094*^9}, {
  3.872605824318584*^9, 3.872605868832036*^9}, {3.872606091643444*^9, 
  3.872606112543569*^9}, {3.872606168380599*^9, 3.872606267313341*^9}, {
  3.872606303292305*^9, 3.8726063462168293`*^9}, {3.872606485778556*^9, 
  3.872606553281641*^9}, {3.8726065883552017`*^9, 3.8726067113781557`*^9}, {
  3.872786966614168*^9, 3.872786975896369*^9}, {3.872787030730459*^9, 
  3.872787239515513*^9}, {3.872787297750293*^9, 3.872787306407824*^9}, {
  3.87278736189815*^9, 3.872787568846875*^9}, {3.8727879326124697`*^9, 
  3.872788126973179*^9}, {3.8727882760689096`*^9, 3.872788278783264*^9}, {
  3.872788341671139*^9, 3.872788469170724*^9}, {3.872788505335741*^9, 
  3.8727885069799337`*^9}, {3.872788544085161*^9, 3.872788552821328*^9}, {
  3.872788716900527*^9, 3.872788749064355*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5b02253c-359c-4203-8f27-7211fad6bb62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"g_Graph", ",", "cFFexpr_", ",", "numerics_", ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"DEBUG", "->", "True"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ResPerOrientations", ",", "OSEReplacement", ",", "ShiftsReplacement", 
       ",", "lmbEdges", ",", "externalEdges", ",", "reducedGraph"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lmbEdges", "=", 
       RowBox[{"GetLMBEdges", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"externalEdges", "=", 
       RowBox[{"GetExternalEdges", "[", "g", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedGraph", "=", 
       RowBox[{"GraphDifference", "[", 
        RowBox[{"g", ",", 
         RowBox[{"DirectedGraph", "[", "externalEdges", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"OSEReplacement", " ", "=", " ", 
       RowBox[{"ComputeOSEReplacements", "[", 
        RowBox[{"g", ",", "numerics"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "DEBUG", "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "OSEReplacement", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ShiftsReplacement", " ", "=", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pE", "[", "iExt", "]"}], ":>", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<p\>\"", "<>", 
              RowBox[{"ToString", "[", "iExt", "]"}], "<>", "\"\<E\>\""}], 
             "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"iExt", ",", 
            RowBox[{"Length", "[", "externalEdges", "]"}]}], "}"}]}], "]"}], "/.",
         "numerics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResPerOrientations", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"st", "[", "\"\<Num\>\"", "]"}], "/.", 
                 "OSEReplacement"}], ")"}], "/.", "numerics"}], ")"}], "/", 
             "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{"Times", "@@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"OSE", "[", "e", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"eta", "[", "\"\<OSE\>\"", "]"}]}], "}"}]}], 
                    "]"}], "]"}], "/.", "OSEReplacement"}], ")"}], "+", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"pE", "[", "s", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"Length", "[", "externalEdges", "]"}]}], "}"}]}], 
                    "]"}], ".", 
                    RowBox[{"eta", "[", "\"\<shift_signature\>\"", "]"}]}], 
                    ")"}], "/.", "ShiftsReplacement"}], ")"}]}], ")"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"eta", ",", " ", 
                   RowBox[{"st", "[", "\"\<Esurfs\>\"", "]"}]}], "}"}]}], 
                "]"}]}], ")"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"st", ",", 
              RowBox[{"t", "[", "\"\<Terms\>\"", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "cFFexpr"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "\[ImaginaryI]", ")"}], 
          RowBox[{"Length", "[", "lmbEdges", "]"}]], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "*", 
                RowBox[{"OSE", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"e", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", 
                    "props"}], "}"}]}], ")"}], "[", "\"\<id\>\"", "]"}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"e", ",", 
                 RowBox[{"EdgeList", "[", "reducedGraph", "]"}]}], "}"}]}], 
              "]"}]}], ")"}], "/.", "OSEReplacement"}], ")"}]}], " ", ")"}], 
       "*", 
       RowBox[{"Total", "[", "ResPerOrientations", "]"}]}]}]}], "\n", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{
  3.872787572150342*^9, {3.872787782578068*^9, 3.872787859158001*^9}, {
   3.87278815807412*^9, 3.8727882267175503`*^9}, {3.872788350738667*^9, 
   3.87278835283304*^9}, {3.872788503318836*^9, 3.872788503528893*^9}, {
   3.872788661706554*^9, 3.872788669033774*^9}, {3.872788806314595*^9, 
   3.872788824546769*^9}, {3.872789039208415*^9, 3.872789113891802*^9}, {
   3.872789510686288*^9, 3.872789513116153*^9}, {3.872791057289459*^9, 
   3.87279105901617*^9}, {3.872791091989052*^9, 3.872791122885467*^9}, {
   3.872791531835136*^9, 3.872791537322981*^9}, 3.87279157585142*^9, {
   3.872793648961095*^9, 3.8727936531223087`*^9}, {3.8727937017232924`*^9, 
   3.872793736969358*^9}, {3.8727938386879177`*^9, 3.872793843485783*^9}, {
   3.872793947118122*^9, 3.8727939842301607`*^9}, {3.872795071425541*^9, 
   3.8727950736552963`*^9}, {3.8728396821008587`*^9, 3.872839705621004*^9}},
 CellLabel->
  "In[723]:=",ExpressionUUID->"efb2f9aa-632f-4dd7-bcce-6af3e3458c27"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.872600809074922*^9, 3.872600845432755*^9}, {
  3.872796053289847*^9, 
  3.8727960541574793`*^9}},ExpressionUUID->"ef225625-0b88-45fb-8fdb-\
f255a2a686c7"],

Cell[CellGroupData[{

Cell["Box1L", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872789766163183*^9, 3.872789776950885*^9}, {3.87279690567933*^9, 
  3.8727969077109213`*^9}},ExpressionUUID->"a3e5066a-c60e-45ea-ac90-\
7db4e61b0b23"],

Cell[CellGroupData[{

Cell["no external, no masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 
  3.8727969090820427`*^9}},ExpressionUUID->"796ffb14-c098-4ac3-84da-\
e0229f44bbc2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Box1L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "4", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Box1L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"Box1L", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"<|", 
        RowBox[{"3", "->", "0"}], "|>"}]}], ",", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", "1", "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "600"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.872742741603726*^9, 3.872742775586288*^9}, {
   3.872743362817617*^9, 3.872743387499469*^9}, {3.872743487367777*^9, 
   3.872743524782481*^9}, {3.872743958621933*^9, 3.872743975587399*^9}, {
   3.872744266098577*^9, 3.872744273043355*^9}, {3.872744435398158*^9, 
   3.872744461440112*^9}, {3.872745114500924*^9, 3.8727451300396833`*^9}, {
   3.872745772099901*^9, 3.872745776468544*^9}, 3.872786297553876*^9},
 CellLabel->
  "In[526]:=",ExpressionUUID->"cfae60b0-1f28-4f0c-8a13-9b75b1b17ba3"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 
      4}, {{{1, 2}, {2, 3}, {3, 4}, {4, 1}}, 
       Null, {<|"id" -> 1, "sig" -> {{1}, {}}, "mass" -> 0|>, <|
        "id" -> 2, "sig" -> {{1}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{1}, {}}, "mass" -> 0|>, <|
        "id" -> 4, "sig" -> {{1}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 600}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-1., 1.0106430996148606`*^-15}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {-0.4999999999999997, -0.4999999999999995},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{6.049014748177263*^-16, -1.}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5000000000000003, -0.5000000000000006},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {-7.044813998280222*^-16, 
          1.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.49999999999999967, 0.49999999999999944},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {-0.5000000000000003, 0.5000000000000006},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-1., 1.0106430996148606*^-15}, 0.02261146496815286], 
        DiskBox[{6.049014748177263*^-16, -1.}, 0.02261146496815286], 
        DiskBox[{1., -1.133107779529596*^-15}, 0.02261146496815286], 
        DiskBox[{-7.044813998280222*^-16, 1.}, 0.02261146496815286]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{3.872786297927058*^9, 3.872788767994326*^9, 
  3.872791474830299*^9, 3.872792694740671*^9, 3.872796958353908*^9},
 CellLabel->
  "Out[527]=",ExpressionUUID->"b02202c0-bf7b-477c-b0e6-cbac6869b005"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Box1Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"Box1L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.872786414205676*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"823f9611-eedf-4267-8323-717a4ed4877c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"k1", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", 
     FractionBox["3", "5"], ",", 
     FractionBox["5", "7"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.872791474923687*^9, 
  3.8727926948529167`*^9, 3.872796958422607*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"899f3a27-8505-4532-bb98-dff6d1267b61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Box1LcLTDexpr", "=", 
  RowBox[{"GeneratecLTDExpression", "[", "Box1L", "]"}]}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"46261589-eed9-491b-bb3f-3804b65678cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"5", " ", "\[ImaginaryI]"}], 
    RowBox[{"32", " ", 
     SuperscriptBox["E0", "7"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"E0", "\[Rule]", 
     SqrtBox[
      RowBox[{"k1", ".", "k1"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786318624598*^9, 3.8727914751132603`*^9, 
  3.872792694997361*^9, 3.872796958629616*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"1ee981d2-9e2e-4bf3-9b39-9f86790cf41b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvalcLTD", "[", 
  RowBox[{"Box1LcLTDexpr", ",", "Box1Lnumerics"}], "]"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"529afaac-2080-4dd8-aafc-17946f138f6a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"703550211328125", " ", "\[ImaginaryI]"}], 
  RowBox[{"97434946105088", " ", 
   SqrtBox["14494"]}]]], "Output",
 CellChangeTimes->{3.87278618513922*^9, 3.872786381566922*^9, 
  3.872786419209247*^9, 3.8727914751305933`*^9, 3.872792695049765*^9, 
  3.8727969586437263`*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"cb298848-d952-4600-b786-56a9769f2764"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Box1LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"Box1L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}},
 CellLabel->
  "In[531]:=",ExpressionUUID->"86cd4bf9-d934-4f35-8aea-12eb3c46eca6"],

Cell["Or see the factorised human-readable expression as follows:", "Text",
 CellChangeTimes->{{3.872792674564254*^9, 
  3.872792684783657*^9}},ExpressionUUID->"b77fddd6-10ce-4d11-85fb-\
1c160968703a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossFreeFamilyLTD", "[", 
   RowBox[{"Box1L", ",", 
    RowBox[{"ConvertToNormalisedFormat", "->", "False"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.872791695444272*^9, 3.872791696922173*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"8810b010-305d-49af-8542-2f71131288dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "3", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "False", ",", "True"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "3", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "2", "]"}], "+", 
        RowBox[{"OSE", "[", "3", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "False", ",", "True", ",", "True"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "False", ",", "True", ",", "False"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "3", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "3", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "2", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "False", ",", "False", ",", "True"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "3", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "3", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "2", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "True", ",", "True", ",", "True"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "True", ",", "True", ",", "False"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "3", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "True", ",", "False", ",", "True"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "3", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "True", ",", "False", ",", "False"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "False", ",", "True", ",", "True"}], "}"}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "1", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OSE", "[", "2", "]"}], "+", 
            RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "False", ",", "True", ",", "False"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "3", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]},
     {
      RowBox[{"{", 
       RowBox[{"False", ",", "False", ",", "False", ",", "True"}], "}"}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "1", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "2", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OSE", "[", "3", "]"}], "+", 
          RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.87279169384062*^9, 3.872791697337102*^9}, 
   3.872792624607647*^9, {3.872792687452586*^9, 3.872792695133636*^9}, 
   3.872796958706105*^9},
 CellLabel->
  "Out[532]//MatrixForm=",ExpressionUUID->"c33c8dcd-fed6-4792-b0c9-\
07ad91030f34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvalcFF", "[", 
  RowBox[{"Box1L", ",", "Box1LcFFexpr", ",", "Box1Lnumerics"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}},
 CellLabel->
  "In[533]:=",ExpressionUUID->"02bb3d73-9b06-4699-9eb0-c7cc08034c27"],

Cell[BoxData[
 FractionBox[
  RowBox[{"703550211328125", " ", "\[ImaginaryI]"}], 
  RowBox[{"97434946105088", " ", 
   SqrtBox["14494"]}]]], "Output",
 CellChangeTimes->{
  3.872787665480044*^9, 3.872787768431295*^9, {3.872787846008459*^9, 
   3.8727878654096518`*^9}, 3.872788136336422*^9, {3.872788195710438*^9, 
   3.8727882327700872`*^9}, 3.872788283527658*^9, 3.872788358324123*^9, 
   3.872788403217894*^9, 3.872788437109745*^9, 3.872788474933714*^9, 
   3.872788515609428*^9, 3.872788557656279*^9, 3.872788674296651*^9, 
   3.872788773453199*^9, 3.872788829062889*^9, {3.872789064064563*^9, 
   3.872789121548465*^9}, {3.8727894993920918`*^9, 3.8727895231079483`*^9}, 
   3.872791475300337*^9, {3.872792689155219*^9, 3.872792695213957*^9}, 
   3.8727969587681637`*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"9bcd7b8f-c7b1-4260-bcf3-d83600464283"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["no external, with masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 
  3.872796919378972*^9}},ExpressionUUID->"e670d7b1-c56f-4158-aa20-\
2692927d337e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Box1L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "4", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "1", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Box1L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"Box1L", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"1", "->", "1"}], ",", 
         RowBox[{"2", "->", "3"}], ",", 
         RowBox[{"3", "->", "5"}], ",", 
         RowBox[{"4", "->", "7"}]}], "|>"}]}], ",", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", "1", "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "600"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.872742741603726*^9, 3.872742775586288*^9}, {
   3.872743362817617*^9, 3.872743387499469*^9}, {3.872743487367777*^9, 
   3.872743524782481*^9}, {3.872743958621933*^9, 3.872743975587399*^9}, {
   3.872744266098577*^9, 3.872744273043355*^9}, {3.872744435398158*^9, 
   3.872744461440112*^9}, {3.872745114500924*^9, 3.8727451300396833`*^9}, {
   3.872745772099901*^9, 3.872745776468544*^9}, 3.872786297553876*^9, {
   3.872790274917819*^9, 3.872790288925702*^9}},
 CellLabel->
  "In[534]:=",ExpressionUUID->"6f88a067-6c6b-4873-bbcf-eb2731b97e0c"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 
      4}, {{{1, 2}, {2, 3}, {3, 4}, {4, 1}}, 
       Null, {<|"id" -> 1, "sig" -> {{1}, {}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{1}, {}}, "mass" -> 3|>, <|
        "id" -> 3, "sig" -> {{1}, {}}, "mass" -> 5|>, <|
        "id" -> 4, "sig" -> {{1}, {}}, "mass" -> 7|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 600}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-1., 1.0106430996148606`*^-15}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "1"}]}], 
           "\[RightAssociation]"}], {-0.4999999999999997, -0.4999999999999995},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{6.049014748177263*^-16, -1.}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "3"}]}], 
           "\[RightAssociation]"}], {0.5000000000000003, -0.5000000000000006},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {-7.044813998280222*^-16, 
          1.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "5"}]}], 
           "\[RightAssociation]"}], {0.49999999999999967, 0.49999999999999944},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "7"}]}], 
           "\[RightAssociation]"}], {-0.5000000000000003, 0.5000000000000006},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-1., 1.0106430996148606*^-15}, 0.02261146496815286], 
        DiskBox[{6.049014748177263*^-16, -1.}, 0.02261146496815286], 
        DiskBox[{1., -1.133107779529596*^-15}, 0.02261146496815286], 
        DiskBox[{-7.044813998280222*^-16, 1.}, 0.02261146496815286]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{3.872786297927058*^9, 3.872788767994326*^9, 
  3.872790289504384*^9, 3.8727914965992603`*^9, 3.87279223973836*^9, 
  3.872792644205378*^9, 3.872792710621421*^9, 3.8727938766080017`*^9, 
  3.872796958823574*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"21915df4-be86-48cc-849c-5ead92f86716"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Box1Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"Box1L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.872786414205676*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"04741e17-dcc6-48b7-b7bc-eb73b15e0613"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"k1", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", 
     FractionBox["3", "5"], ",", 
     FractionBox["5", "7"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727902920938053`*^9, 
  3.872791496735832*^9, 3.872792645722172*^9, 3.872792710727728*^9, 
  3.8727939012616568`*^9, 3.872796958858275*^9},
 CellLabel->
  "Out[536]=",ExpressionUUID->"075ce8fd-e880-4c55-ac64-fc7b77ba1326"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Box1LcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "Box1L", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
   3.872790298671825*^9, 3.872790311584629*^9}, 3.872791501109455*^9, 
   3.872791590062203*^9},
 CellLabel->
  "In[537]:=",ExpressionUUID->"0ff2b356-8ac2-4938-8e93-edbea8555cc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"Box1LcLTDexpr", ",", "Box1Lnumerics"}], "]"}], "//", "N"}], "//",
   "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.87279031615169*^9, 3.872790319619055*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"d6f89575-c604-43cd-a094-bcf4c17b272d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Complex", "[", 
    RowBox[{"0.`", ",", "0.00001429981765142814`"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.87278618513922*^9, 3.872786381566922*^9, 3.872786419209247*^9, {
   3.8727903137428703`*^9, 3.872790319913768*^9}, {3.872791496943288*^9, 
   3.872791513697809*^9}, 3.8727926500779943`*^9, 3.872792710924418*^9, 
   3.872793902616531*^9, 3.872796959053012*^9},
 CellLabel->
  "Out[538]//FullForm=",ExpressionUUID->"6298eb56-55db-4d05-8354-\
8850fffb152e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Box1LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"Box1L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"f2511339-bd98-4cf1-baa8-5926c7a1c902"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"Box1L", ",", "Box1LcFFexpr", ",", "Box1Lnumerics"}], "]"}], "//",
    "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
  3.87279032481947*^9, 3.872790327755477*^9}},
 CellLabel->
  "In[540]:=",ExpressionUUID->"6009c3a7-b9a1-42f8-991b-3d76e2ae2384"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Complex", "[", 
    RowBox[{"0.`", ",", "0.00001429981765142814`"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.872787665480044*^9, 3.872787768431295*^9, {3.872787846008459*^9, 
   3.8727878654096518`*^9}, 3.872788136336422*^9, {3.872788195710438*^9, 
   3.8727882327700872`*^9}, 3.872788283527658*^9, 3.872788358324123*^9, 
   3.872788403217894*^9, 3.872788437109745*^9, 3.872788474933714*^9, 
   3.872788515609428*^9, 3.872788557656279*^9, 3.872788674296651*^9, 
   3.872788773453199*^9, 3.872788829062889*^9, {3.872789064064563*^9, 
   3.872789121548465*^9}, {3.8727894993920918`*^9, 3.8727895231079483`*^9}, {
   3.8727903227954903`*^9, 3.8727903279895897`*^9}, {3.872791497115609*^9, 
   3.872791514899329*^9}, 3.8727915552677937`*^9, 3.872792710971843*^9, {
   3.8727938860033503`*^9, 3.8727939039511623`*^9}, 3.872793988537799*^9, 
   3.872796959101974*^9},
 CellLabel->
  "Out[540]//FullForm=",ExpressionUUID->"6d51b615-36ac-489b-8897-\
fcd08e6af48d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["with external, with masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 
  3.8727969320330143`*^9}},ExpressionUUID->"ae7c4cec-3d5a-4896-83c1-\
84bf2e4f7e1b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Box1L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "4", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "1", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"101", ",", "1", ",", "5"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"102", ",", "2", ",", "6"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"103", ",", "3", ",", "7"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"104", ",", "4", ",", "8"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Box1L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"Box1L", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"1", "->", "1"}], ",", 
         RowBox[{"2", "->", "3"}], ",", 
         RowBox[{"3", "->", "5"}], ",", 
         RowBox[{"4", "->", "7"}]}], "|>"}]}], ",", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", "1", "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "500"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.872742741603726*^9, 3.872742775586288*^9}, {
   3.872743362817617*^9, 3.872743387499469*^9}, {3.872743487367777*^9, 
   3.872743524782481*^9}, {3.872743958621933*^9, 3.872743975587399*^9}, {
   3.872744266098577*^9, 3.872744273043355*^9}, {3.872744435398158*^9, 
   3.872744461440112*^9}, {3.872745114500924*^9, 3.8727451300396833`*^9}, {
   3.872745772099901*^9, 3.872745776468544*^9}, 3.872786297553876*^9, {
   3.872789807179264*^9, 3.8727898494597893`*^9}, {3.8727899530754137`*^9, 
   3.87278998200391*^9}, 3.8727931259976683`*^9},
 CellLabel->
  "In[666]:=",ExpressionUUID->"0f51cd45-fe5c-4882-a04c-7fb00de4bd49"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 101, 102, 103, 
      104}, {{{1, 2}, {2, 3}, {3, 4}, {4, 1}, {5, 1}, {6, 2}, {7, 3}, {8, 4}},
        Null, {<|"id" -> 1, "sig" -> {{1}, {0, 0, 0, 0}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{1}, {-1, 0, -1, -1}}, "mass" -> 3|>, <|
        "id" -> 3, "sig" -> {{1}, {-1, 0, 0, -1}}, "mass" -> 5|>, <|
        "id" -> 4, "sig" -> {{1}, {-1, 0, 0, 0}}, "mass" -> 7|>, <|
        "id" -> 5, "sig" -> {{0}, {1, 0, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 6, "sig" -> {{0}, {0, 1, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 7, "sig" -> {{0}, {0, 0, 1, 0}}, "mass" -> 0|>, <|
        "id" -> 8, "sig" -> {{0}, {0, 0, 0, 1}}, "mass" -> 0|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 500}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{1.7325605103796753`, 0.7097616586131177}, {
          0.7350826564730034, 1.3916116752794745`}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "1"}]}], 
           "\[RightAssociation]"}], {1.2338215834263393, 1.0506866669462962}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7350826564730034, 1.3916116752794745`}, {
          0.7420816784057199, 0.7101404240005063}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "3"}]}], 
           "\[RightAssociation]"}], {0.7385821674393617, 1.0508760496399905}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7420816784057199, 0.7101404240005063}, {
          1.738585499883122, 1.392722175719669}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "5"}]}], 
           "\[RightAssociation]"}], {1.240333589144421, 1.0514312998600877}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1.738585499883122, 1.392722175719669}, {
          1.7325605103796753`, 0.7097616586131177}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
              "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "7"}]}], 
           "\[RightAssociation]"}], {1.7355730051313987, 1.0512419171663934}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{2.4635244276416026`, 0.0005156526409129114}, {
          1.7325605103796753`, 0.7097616586131177}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "5"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {2.0980424690106387, 0.3551386556270153}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.0971206719881375`}, {0.7350826564730034, 
          1.3916116752794745`}}, 0.026328488431371533`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "6"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.3675413282365017, 1.7443661736338059}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.011944592734826065`, 0.}, {0.7420816784057199, 
          0.7101404240005063}}, 0.026328488431371533`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "7"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.377013135570273, 0.3550702120002531}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{2.4718731713742264`, 2.0996304825338625`}, {
          1.738585499883122, 1.392722175719669}}, 0.026328488431371533`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "8"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {2.105229335628674, 1.7461763291267658}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{1.7325605103796753, 0.7097616586131177}, 
         0.026328488431371533], 
        DiskBox[{0.7350826564730034, 1.3916116752794745}, 
         0.026328488431371533], 
        DiskBox[{0.7420816784057199, 0.7101404240005063}, 
         0.026328488431371533], 
        DiskBox[{1.738585499883122, 1.392722175719669}, 0.026328488431371533],
         DiskBox[{2.4635244276416026, 0.0005156526409129114}, 
         0.026328488431371533], 
        DiskBox[{0., 2.0971206719881375}, 0.026328488431371533], 
        DiskBox[{0.011944592734826065, 0.}, 0.026328488431371533], 
        DiskBox[{2.4718731713742264, 2.0996304825338625}, 
         0.026328488431371533]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->500]], "Output",
 CellChangeTimes->{
  3.872786297927058*^9, 3.872788767994326*^9, 3.8727898504097223`*^9, {
   3.87278995375004*^9, 3.872789982351449*^9}, 3.872791385364929*^9, 
   3.87279271938628*^9, 3.8727931265441027`*^9, 3.8727937953223124`*^9, 
   3.8727940029611588`*^9, 3.872795050199144*^9, 3.872795146157707*^9, 
   3.8727951858696003`*^9, {3.872796959140242*^9, 3.872796985274685*^9}, 
   3.872838078568451*^9},
 CellLabel->
  "Out[667]=",ExpressionUUID->"be6a9ee8-b966-4d61-8c81-ca9827b145c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Box1Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"Box1L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.872786414205676*^9}},
 CellLabel->
  "In[668]:=",ExpressionUUID->"4361f300-2f4c-45e2-bf10-e5127d8a827a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}], ",", 
   RowBox[{"p2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["17", "19"], ",", 
      FractionBox["19", "23"], ",", 
      FractionBox["23", "29"]}], "}"}]}], ",", 
   RowBox[{"p3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["29", "31"], ",", 
      FractionBox["31", "37"], ",", 
      FractionBox["37", "41"]}], "}"}]}], ",", 
   RowBox[{"p1E", "\[Rule]", 
    FractionBox["41", "43"]}], ",", 
   RowBox[{"p2E", "\[Rule]", 
    FractionBox["43", "47"]}], ",", 
   RowBox[{"p3E", "\[Rule]", 
    FractionBox["47", "53"]}], ",", 
   RowBox[{"p4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["15981", "6479"]}], ",", 
      RowBox[{"-", 
       FractionBox["27769", "11063"]}], ",", 
      RowBox[{"-", 
       FractionBox["49729", "20213"]}]}], "}"}]}], ",", 
   RowBox[{"p4E", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["295115", "107113"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727902920938053`*^9, 
  3.872791496735832*^9, 3.872792645722172*^9, 3.872792710727728*^9, 
  3.8727939012616568`*^9, 3.872796958858275*^9, 3.872797018872765*^9, 
  3.872838106625805*^9},
 CellLabel->
  "Out[668]=",ExpressionUUID->"16583879-d544-4c37-a7e4-ff4b31885054"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Box1LcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "Box1L", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727901475343237`*^9, 3.8727901484026947`*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"64462c33-6a32-40e8-ad26-217148f093f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"Box1LcLTDexpr", ",", "Box1Lnumerics"}], "]"}], "//", "N"}], "//",
   "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872790160242073*^9, 3.872790165934816*^9}, {
   3.8727969927487087`*^9, 3.87279699363657*^9}, {3.872797026132416*^9, 
   3.872797029241851*^9}},
 CellLabel->
  "In[670]:=",ExpressionUUID->"3efc3722-2b15-4699-b8b6-25bb347dbf75"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Complex", "[", 
    RowBox[{"0.`", ",", "7.180137420795949`*^-6"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.87278618513922*^9, 3.872786381566922*^9, 3.872786419209247*^9, {
   3.8727901572656393`*^9, 3.872790166135623*^9}, 3.872790246764901*^9, 
   3.872791393235853*^9, 3.8727914327206163`*^9, 3.8727927196964693`*^9, 
   3.872792794870405*^9, {3.872793108442947*^9, 3.872793148034659*^9}, {
   3.872793789267529*^9, 3.872793802215947*^9}, 3.872794014844716*^9, {
   3.8727940724891644`*^9, 3.872794076429948*^9}, {3.872794120657174*^9, 
   3.872794123811221*^9}, 3.872795052804162*^9, 3.872795146427635*^9, 
   3.872795186130743*^9, {3.872796959473439*^9, 3.872797029458754*^9}, 
   3.872838120364402*^9},
 CellLabel->
  "Out[670]//FullForm=",ExpressionUUID->"2130eada-f77f-4dc1-9b29-\
e4f984fcee8a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Box1LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"Box1L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, 
   3.8727947613375397`*^9, 3.8727948931357603`*^9},
 CellLabel->
  "In[556]:=",ExpressionUUID->"5e4a8629-8c17-43d0-918d-d89c085e1031"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"Box1L", ",", "Box1LcFFexpr", ",", "Box1Lnumerics"}], "]"}], "//",
    "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
   3.872790175456388*^9, 3.8727901759693403`*^9}, 3.872791429962783*^9},
 CellLabel->
  "In[671]:=",ExpressionUUID->"dddb162a-5393-4aa1-977a-d574c80b528c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Complex", "[", 
    RowBox[{"0.`", ",", "7.180137420795949`*^-6"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.872794754552086*^9, {3.87279488618064*^9, 3.8727948948837633`*^9}, {
   3.8727950116670637`*^9, 3.87279501473565*^9}, {3.872795054088789*^9, 
   3.872795079896693*^9}, 3.8727951464747458`*^9, 3.872795186186881*^9, 
   3.872796959599504*^9, 3.872797031605111*^9, 3.872838124903583*^9},
 CellLabel->
  "Out[671]//FullForm=",ExpressionUUID->"bb747137-ad90-4052-9f6c-\
5da256a5ab24"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Banana2L", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872678248328179*^9, 3.87267825122709*^9}, {3.87279670170677*^9, 
  3.872796729672701*^9}, {3.8727967652077217`*^9, 3.872796767707892*^9}, {
  3.872797241114916*^9, 
  3.8727972420807867`*^9}},ExpressionUUID->"f4fc9078-961d-4d4a-ac07-\
c31f0451b726"],

Cell[CellGroupData[{

Cell["no external, no masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 
  3.8727969090820427`*^9}},ExpressionUUID->"8913c183-da1c-4fdb-a5e1-\
cb4225002846"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Banana2L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Banana2L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"Banana2L", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"<|", 
        RowBox[{"3", "->", "0"}], "|>"}]}], ",", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872796776090105*^9, 3.8727968245116453`*^9}, {3.872797249833877*^9, 
  3.872797274475143*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"8c49536e-7d08-442e-861e-fa6e567f40ed"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 
      2}, {{{1, 2}, {1, 2}, {1, 2}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 600}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[BezierCurveBox[{{1., 0.}, {
          0.5000000000000006, -0.16444074718311627`}, {0., 
          1.2246467991473532`*^-16}}], 0.01273], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5000000000000001, -0.07}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 0.}, {0., 1.2246467991473532`*^-16}}, 0.01273], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5, 6.123233995736766*^-17}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1., 0.}, {0.5000000000000001, 
          0.16444074718311646`}, {0., 1.2246467991473532`*^-16}}], 0.01273], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5000000000000001, 0.07000000000000012},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{1., 0.}, 0.01273], 
        DiskBox[{0., 1.2246467991473532*^-16}, 0.01273]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{{3.872786282581215*^9, 3.87278629371031*^9}, 
   3.872788848268298*^9, 3.8727951888519077`*^9, {3.872796810473688*^9, 
   3.872796825004677*^9}, 3.8727970720844097`*^9, {3.872797261102105*^9, 
   3.8727972863079576`*^9}},
 CellLabel->
  "Out[579]=",ExpressionUUID->"0129e826-8253-4226-8fa0-ea137edf0dcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Banana2Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"Banana2L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.8727864421208963`*^9}, {
  3.8727968356803703`*^9, 3.872796837729765*^9}, {3.872797293584964*^9, 
  3.872797298301733*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"03d498ac-2dc7-4928-bf90-e1c005530e8b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727864579020023`*^9, 
  3.872788860838923*^9, 3.872795189139636*^9, 3.872796838705688*^9, 
  3.872797072397326*^9, 3.872797298550098*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"48ebd1c1-f1ff-4ee1-ad97-66870adca898"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Banana2LcLTDexpr", "=", 
  RowBox[{"GeneratecLTDExpression", "[", "Banana2L", "]"}]}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727901475343237`*^9, 3.8727901484026947`*^9}, {3.8727971695359497`*^9, 
  3.872797171423841*^9}, {3.872797304152014*^9, 3.8727973179909277`*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"24663029-3cfa-4912-beb3-ab5c4eb2544e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", "E0", " ", "E1", " ", "E2", " ", 
     RowBox[{"(", 
      RowBox[{"E0", "+", "E1", "+", "E2"}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"E0", "\[Rule]", 
      SqrtBox[
       RowBox[{"k1", ".", "k1"}]]}], ",", 
     RowBox[{"E1", "\[Rule]", 
      SqrtBox[
       RowBox[{
        RowBox[{"k1", ".", "k1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k1", ".", "k2"}]}], "+", 
        RowBox[{"k2", ".", "k2"}]}]]}], ",", 
     RowBox[{"E2", "\[Rule]", 
      SqrtBox[
       RowBox[{"k2", ".", "k2"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872797318372129*^9},
 CellLabel->
  "Out[583]=",ExpressionUUID->"a4f3c0b3-5705-4693-88da-40da6c0ad069"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"Banana2LcLTDexpr", ",", "Banana2Lnumerics"}], "]"}], "//", "N"}],
   "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872790160242073*^9, 3.872790165934816*^9}, {
   3.8727969927487087`*^9, 3.87279699363657*^9}, {3.872797026132416*^9, 
   3.872797029241851*^9}, {3.872797176299097*^9, 3.872797179288602*^9}, {
   3.8727973232861633`*^9, 3.872797326323462*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"747718de-4696-4d6e-9770-9bf123c09a2c"],

Cell[BoxData[
 TagBox[
  StyleBox["0.013944200210337859`",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.872797181057626*^9, 3.8727973266632013`*^9},
 CellLabel->
  "Out[584]//FullForm=",ExpressionUUID->"e5ff18f3-a10e-4e96-a9ba-\
28f1463b5fbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Banana2LcFFexpr", "=", 
  RowBox[{"CrossFreeFamilyLTD", "[", 
   RowBox[{"Banana2L", ",", 
    RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, 
   3.8727947613375397`*^9, 3.8727948931357603`*^9, {3.872797111531693*^9, 
   3.872797113331418*^9}, {3.872797340526545*^9, 3.87279734564822*^9}},
 CellLabel->
  "In[585]:=",ExpressionUUID->"8ca1db18-957d-492f-aa75-bccda27aa4c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Orientation\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"\<\"Terms\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\<\"Num\"\>", "\[Rule]", "1"}], ",", 
         RowBox[{"\<\"Orderings\"\>", "\[Rule]", "Null"}], ",", 
         RowBox[{"\<\"Esurfs\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"\<\"OSE\"\>", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
             RowBox[{"\<\"shift_signature\"\>", "\[Rule]", 
              RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], "}"}]}]}], 
        "\[RightAssociation]"}], "}"}]}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Orientation\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"\<\"Terms\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\<\"Num\"\>", "\[Rule]", "1"}], ",", 
         RowBox[{"\<\"Orderings\"\>", "\[Rule]", "Null"}], ",", 
         RowBox[{"\<\"Esurfs\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"\<\"OSE\"\>", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ",", 
             RowBox[{"\<\"shift_signature\"\>", "\[Rule]", 
              RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], "}"}]}]}], 
        "\[RightAssociation]"}], "}"}]}]}], "\[RightAssociation]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.872797355695294*^9},
 CellLabel->
  "Out[585]=",ExpressionUUID->"951b40ad-d8e7-4a48-b9f1-e54f00bbc839"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"Banana2L", ",", "Banana2LcFFexpr", ",", "Banana2Lnumerics"}], 
    "]"}], "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
   3.872790175456388*^9, 3.8727901759693403`*^9}, 3.872791429962783*^9, {
   3.872797114945732*^9, 3.8727971220428133`*^9}, {3.8727973484816093`*^9, 
   3.8727973546849823`*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"8026b1ba-cf50-4526-9c9d-a86154158154"],

Cell[BoxData[
 TagBox[
  StyleBox["0.013944200210337859`",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.872797124655748*^9, 3.872797362511457*^9},
 CellLabel->
  "Out[586]//FullForm=",ExpressionUUID->"d694f363-d7f1-4f07-8497-\
031d14c68063"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DottedBanana2L", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872678248328179*^9, 3.87267825122709*^9}, {3.87279670170677*^9, 
  3.872796729672701*^9}, {3.8727967652077217`*^9, 3.872796767707892*^9}, {
  3.872839197215168*^9, 
  3.8728392006943483`*^9}},ExpressionUUID->"5560251c-5e10-46f1-86dd-\
7d8654fb5a27"],

Cell[CellGroupData[{

Cell["no external, with masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 3.8727969090820427`*^9}, {
  3.8728482588602047`*^9, 
  3.872848259603689*^9}},ExpressionUUID->"18aa0db7-cbde-4389-8b40-\
476fa13ef978"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myGraph", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "3", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "2", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"myGraph", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"myGraph", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"Association", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "[", "4", "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
      
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872796776090105*^9, 3.8727968245116453`*^9}, {3.872797249833877*^9, 
  3.872797274475143*^9}, {3.8728392143736153`*^9, 3.872839275715823*^9}, {
  3.872848250138526*^9, 3.872848284941457*^9}},
 CellLabel->
  "In[806]:=",ExpressionUUID->"7df8cd5c-433d-4640-94c1-226ea79a638b"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 
      3}, {{{1, 2}, {1, 2}, {1, 3}, {3, 2}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 2|>, <|
        "id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{-1, -1}, {}}, "mass" -> 4|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 400}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQjQYctC1fnevl32R/6vaWVfZt/+2vPTZL9zhyyF43
YfuF9If/7A+Huta3mJ611+hlL6oQ/GevY3lh+l7dK/a7kpb2FYr9tT8no2Ij
Jn3L/smDCWrBH37bP9LyF0szfGC/nP2Upez8X/YcRfO35Dc9tme4HnDivNJP
+5uPmX4uZ3hu/8VP9VJW9Xf70IbKx3xrXtnX5buHv1vx1X5JpJqy4so39s9P
3G6cMvGL/dPOfiHL7Hf2pVm7RL7nfrYXE9y6MezTe3uNkMf8Ynaf7GeVezPY
zv9g/681rPgj40d7hUmz6i+qf7T//F+9Tqj4vb3cjePXXkz6aG/UYv5s18k3
9lM8L7M2P/hov2PGbbk77K/sG5/t4Vkg8Mm+y1ZEo0z3uf3TdS2v7ZU/2S8q
esjYafXE3nqdn8tH+U/21zwqri8PeGj/573dTie+T/afFkqvOK10116zJNTL
5N1HezExl/etP6/bH7Ca9P3o/o/2Iu8yW+pUL9sfdv564HvTR/sHwVLns3zP
2hv11y07af7RPmhytGHoryP23LJ6K6zvfbD/aaIfX7F4l33AW+ZjvmUf7LuW
WqrX+620h0TTB3tYhAEAgeXVIA==
          "]], 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "1"}]}], 
           "\[RightAssociation]"}], {0.9589631330639127, 1.2013339202059627}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQjQYc3vTv2VJ/Zpa9gXye6fS3/+ybVr58Mfvfenun
nWuMFI/9tQ8Suija9WS3vcm53d/ndv6xD3+3UCPL8Kg9W9zsFl6L3/ZvZqYF
i+09a78jw/tm/sWf9p9cZx9dcuqyvc+701+PhP6wV3zE8YIx9qb9gXcyt3iO
frNvVvwzYdHU+/aiWXZt7vJf7XmarBKcrR7beyYY/CpJ+Wyf5TndbiPnU3sO
R44ff3I+2X9a5sqwYeEz+58hovISWR/tl8xyXWrP9MJeek54/rHoD/b1KtN1
E7Rf2l/XmXeRv+WdfYuL1UxB2Vf2d9u/i+20fGO/6Zfei+Drr+xdPXev67jx
0p7LvVRKPeq1PU/hyxl1Cc/tezR5DbqXvra3+N94ddbFJ/Zmi75pNOx8bX/k
c0vKXe1H9l2Lk8plD7y2P2Nit3699H17DoWm3qrHr+2X1/5qMNe5Zb9JPDR7
uvIbe8lDdnZBnVftG7tuC5Q0vLGXZeJ+/t/oon11hWidwK839oXV+741BJ2y
n/eQaXPOhLf2V1+WfVO/ccj+1dHF6zuc39kfmVc36+Xb7faJqj+KU4Tf2xds
iHszd/cye0g0fbCHRRgAJFnW8A==
          "]], 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "2"}]}], 
           "\[RightAssociation]"}], {0.7026277287078223, 1.094251860240009}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {0., 1.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "3"}]}], 
           "\[RightAssociation]"}], {0., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {1., 0.}}, 0.02261146496815286], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "4"}]}], 
           "\[RightAssociation]"}], {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{0., 2.}, 0.02261146496815286], 
        DiskBox[{1., 0.}, 0.02261146496815286], 
        DiskBox[{0., 1.}, 0.02261146496815286]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->400]], "Output",
 CellChangeTimes->{{3.872839267121853*^9, 3.87283927626737*^9}, 
   3.8728483259372797`*^9},
 CellLabel->
  "Out[807]=",ExpressionUUID->"03a33bc3-fe0e-4c39-b7b4-7f4b730cb906"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myGraphcLTDexpr", "=", 
  RowBox[{"GeneratecLTDExpression", "[", "myGraph", "]"}]}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727864358378*^9, 3.872786437591256*^9}, {3.872796829782374*^9, 
  3.8727968318114767`*^9}, {3.872839296808667*^9, 3.8728392986362343`*^9}},
 CellLabel->
  "In[808]:=",ExpressionUUID->"7b8c7e9a-75b6-4132-8fa6-6bc5344b5a8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      FractionBox["2", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E1", "+", "E2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"E0", "+", "E1", "+", "E3"}], ")"}]}]], "+", 
      FractionBox["2", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E1", "+", "E2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}]}]], "+", 
      FractionBox["2", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E0", "+", "E1", "+", "E3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}]}]]}], 
     RowBox[{"16", " ", "E0", " ", "E1", " ", "E2", " ", "E3"}]]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"E0", "\[Rule]", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"k1", ".", "k1"}]}]]}], ",", 
     RowBox[{"E1", "\[Rule]", 
      SqrtBox[
       RowBox[{"9", "+", 
        RowBox[{"k1", ".", "k1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k1", ".", "k2"}]}], "+", 
        RowBox[{"k2", ".", "k2"}]}]]}], ",", 
     RowBox[{"E2", "\[Rule]", 
      SqrtBox[
       RowBox[{"16", "+", 
        RowBox[{"k1", ".", "k1"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k1", ".", "k2"}]}], "+", 
        RowBox[{"k2", ".", "k2"}]}]]}], ",", 
     RowBox[{"E3", "\[Rule]", 
      SqrtBox[
       RowBox[{"4", "+", 
        RowBox[{"k2", ".", "k2"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786318624598*^9, 3.8727864555233927`*^9, 
  3.872788856792451*^9, 3.8727951891224527`*^9, 3.872796832681644*^9, 
  3.872797072350286*^9, 3.872838267858527*^9, 3.8728391344927397`*^9, 
  3.8728392991333523`*^9, 3.872848326323722*^9},
 CellLabel->
  "Out[808]=",ExpressionUUID->"7a6e5973-2e36-4a82-97f4-41f0dcd7c584"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myGraphnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"myGraph", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[809]:=",ExpressionUUID->"39b04623-0359-416f-a7f4-848903b329dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.872786415168228*^9, 3.8727864579020023`*^9, 3.872788860838923*^9, 
   3.872795189139636*^9, 3.872796838705688*^9, 3.872797072397326*^9, {
   3.8728393135855627`*^9, 3.87283932546511*^9}, 3.8728483263422403`*^9},
 CellLabel->
  "Out[809]=",ExpressionUUID->"aa169cc6-1bc5-48db-8f59-49f271bacf9d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGraphcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "myGraph", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727901475343237`*^9, 3.8727901484026947`*^9}, {3.8727971695359497`*^9, 
  3.872797171423841*^9}, {3.872839333612101*^9, 3.872839340031954*^9}},
 CellLabel->
  "In[810]:=",ExpressionUUID->"acd24b9a-ee5e-42f7-b6a5-a8155cc26425"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"myGraphcLTDexpr", ",", "myGraphnumerics"}], "]"}], "//", "N"}], "//",
   "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872790160242073*^9, 3.872790165934816*^9}, {
   3.8727969927487087`*^9, 3.87279699363657*^9}, {3.872797026132416*^9, 
   3.872797029241851*^9}, {3.872797176299097*^9, 3.872797179288602*^9}, {
   3.872839342897603*^9, 3.8728393460185013`*^9}},
 CellLabel->
  "In[811]:=",ExpressionUUID->"4854823a-813f-4809-93a0-a03df0d40ffe"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"-", "0.00008258560765424002`"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.872797181057626*^9, 3.872826489355402*^9, 3.8728382940172577`*^9, {
   3.872839347841701*^9, 3.8728393503615217`*^9}, 3.872848326642219*^9},
 CellLabel->
  "Out[811]//FullForm=",ExpressionUUID->"a0cddf38-38ed-45b4-92a3-\
983549a77a75"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGraphcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"myGraph", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, 
   3.8727947613375397`*^9, 3.8727948931357603`*^9, {3.872797111531693*^9, 
   3.872797113331418*^9}, {3.872839354566598*^9, 3.872839362682938*^9}},
 CellLabel->
  "In[812]:=",ExpressionUUID->"893d6925-49b3-4166-9979-92918c1dc968"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"myGraph", ",", "myGraphcFFexpr", ",", "myGraphnumerics"}], "]"}],
    "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
   3.872790175456388*^9, 3.8727901759693403`*^9}, 3.872791429962783*^9, {
   3.872797114945732*^9, 3.8727971220428133`*^9}, {3.872839375927506*^9, 
   3.872839391005571*^9}, {3.872839738836467*^9, 3.8728397416711693`*^9}, {
   3.872840700060615*^9, 3.8728407047015047`*^9}, {3.8728483085358257`*^9, 
   3.872848309657299*^9}},
 CellLabel->
  "In[813]:=",ExpressionUUID->"48bd1a16-deed-4dcc-9ffe-a934e9a38ef3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"-", "0.00008258560765424002`"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.872797124655748*^9, 3.872826481706263*^9, {3.872839381854567*^9, 
   3.8728393913053303`*^9}, 3.8728397421637707`*^9, {3.872840695444458*^9, 
   3.872840704972547*^9}, 3.872848326705823*^9},
 CellLabel->
  "Out[813]//FullForm=",ExpressionUUID->"e7794a14-d27f-4d49-b43c-\
6b7f766957d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrossFreeFamilyLTD", "[", 
  RowBox[{"myGraph", ",", 
   RowBox[{"ConvertToNormalisedFormat", "->", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Orientations", "->", 
    RowBox[{"{", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"o", "===", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{
          RowBox[{
          "myGraphcFFexpr", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], "[", "\"\<Orientation\>\"", "]"}]}], 
        "}"}]}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"DEBUG", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87282418927404*^9, 3.872824219144011*^9}, {
  3.872824254878398*^9, 3.8728242581442204`*^9}, {3.872839415729059*^9, 
  3.872839418700735*^9}, {3.872839547666482*^9, 3.872839547751975*^9}},
 CellLabel->
  "In[814]:=",ExpressionUUID->"c1b3346d-5369-43aa-81e9-bafc930dc865"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Now considering orientation: {-1, -1, 1, -1}\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326760268*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"25735fc6-f7c4-4665-9472-89ba83775c81"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326764318*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"fac4d0fe-5b7d-4213-ab10-97566beb177b"],

Cell[BoxData["\<\"Now considering the following graph:\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326768849*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"f81db64c-a187-4c50-988f-38356cebd7a3"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{2, 1, 
      3}, {{{1, 2}, {1, 2}, {2, 3}, {1, 3}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 2|>, <|
        "id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{-1, -1}, {}}, "mass" -> 4|>}}, {
      EdgeLabels -> {
        DirectedEdge[2, 1, <|"id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 2|>] -> 
         2, DirectedEdge[
          2, 3, <|"id" -> 4, "sig" -> {{-1, -1}, {}}, "mass" -> 4|>] -> 4, 
         DirectedEdge[
          2, 1, <|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 1|>] -> 1, 
         DirectedEdge[
          1, 3, <|"id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 3|>] -> 3}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[BezierCurveBox[{{0., 2.}, {0.16444074718311635`, 
          1.500000000000002}, {0., 1.}}], 0.02261146496815286], 
         InsetBox["1", {0.07000000000000006, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{0., 2.}, {-0.16444074718311635`, 
          1.500000000000002}, {0., 1.}}], 0.02261146496815286], 
         InsetBox["2", {-0.07000000000000006, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQjQYcZvKamy4+tMJ+knvYs1eW/+3l1q8JvnV4lz2f
6dGoQ8H/7Kv2zBQ9O/mofdEJn9g237/2Gp+mT/A4ds5+D+Pbt2bqf+x9ajLO
rq+5Yv/2wVKeKw9+2T9JV5LqFLtlz55WvjO26qf9+7s24hESD+w5JiZ+ufz5
u72sjXnrpNTH9p8SU/aa+X6zr/ZjuP750zP7QzfqRdravthHTA4Vtb/5wj61
S8VPrf6z/bmWUJ+Qtlf293uFbN9mf7J/pMRQY/zrtb3+Y8+Ht3w+2vfnhi65
Y/LWPqTrlNV7xQ/211JCj/qbvbOfz6Y5OeTaW/udHAz3e/69s3ea4y8tEfja
3iwy9OPk3vf2E69y8GlueWHvFxb6J+Xxe/ueTSHZ7f+f2kOC5YO9MRg8hvPn
bey+bp//AM4/x989pXH5bXtGKF8856BYzsFrcHnJil2m9jqX4PwV6W8efT1/
Gs6fYvdyst3Lw3D+g5fX/mzw2Ann/9M608nHugLOh0UYALTwvFk=
          "]], 
          0.02261146496815286], 
         InsetBox["4", {0.8288527141529387, 1.1514069002605647}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {1., 0.}}, 0.02261146496815286], 
         InsetBox["3", {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 2.}, 0.02261146496815286], 
         InsetBox["2", 
          Offset[{2, 2}, {0.02261146496815286, 2.022611464968153}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 1.}, 0.02261146496815286], 
         InsetBox["1", 
          Offset[{2, 2}, {0.02261146496815286, 1.0226114649681528}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.02261146496815286], 
         InsetBox["3", 
          Offset[{2, 2}, {1.0226114649681528, 0.02261146496815286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326831827*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"8b266d0a-8bfd-41f3-9ff5-e3f5fb6ca410"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Found the following sources (first one will be considered): \"\
\>", "\[InvisibleSpace]", 
   RowBox[{"{", "2", "}"}]}],
  SequenceForm[
  "Found the following sources (first one will be considered): ", {2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326838798*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"06aaedb2-d5ff-4a8b-abeb-d5ea3d1b2c25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges to be contracted (possibly won't contribute all): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm[
  "Edges to be contracted (possibly won't contribute all): ", {1, 2, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.8728483268417797`*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"042d3816-cfb2-4cc1-a20f-34be3d9a56ee"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Contributing edge contractions: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    TemplateBox[{"2", "1", 
      RowBox[{"\[LeftAssociation]", 
        RowBox[{
          RowBox[{"\"id\"", "\[Rule]", "1"}], ",", 
          RowBox[{"\"sig\"", "\[Rule]", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
          RowBox[{"\"mass\"", "\[Rule]", "1"}]}], "\[RightAssociation]"}]},
     "DirectedEdge"], "}"}]}],
  SequenceForm["Contributing edge contractions: ", {
    DirectedEdge[2, 1, <|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 1|>]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.8728483268446074`*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"2c547cbc-de3f-43d6-a852-8752f65ad114"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Esurf for this term: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm["Esurf for this term: ", {1, 2, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326849368*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"b38e95c9-e719-4cd0-a695-7affff03904a"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326854076*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"aff72103-b9c0-4d78-90a9-888a9c45b7e1"],

Cell[BoxData["\<\"Now considering the following graph:\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.8728483268577843`*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"28e807dc-4269-45ad-a6ce-1376e9b31561"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 
      3}, {{{1, 2}, {1, 2}}, 
       Null, {<|"id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{-1, -1}, {}}, "mass" -> 4|>}}, {
      EdgeLabels -> {
        DirectedEdge[
          1, 3, <|"id" -> 4, "sig" -> {{-1, -1}, {}}, "mass" -> 4|>] -> 4, 
         DirectedEdge[
          1, 3, <|"id" -> 3, "sig" -> {{-1, -1}, {}}, "mass" -> 3|>] -> 3}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[BezierCurveBox[{{1., 0.}, {
          0.5000000000000006, -0.16444074718311627`}, {0., 
          1.2246467991473532`*^-16}}], 0.01273], 
         InsetBox["3", {0.5000000000000001, -0.07}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1., 0.}, {0.5000000000000001, 
          0.16444074718311646`}, {0., 1.2246467991473532`*^-16}}], 0.01273], 
         InsetBox["4", {0.5000000000000001, 0.07000000000000012}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{1., 0.}, 0.01273], 
         InsetBox["1", Offset[{2, 2}, {1.01273, 0.01273}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 1.2246467991473532*^-16}, 0.01273], 
         InsetBox["3", Offset[{2, 2}, {0.01273, 0.012730000000000123}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.872848326948551*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"35c1fae5-5e38-4e49-99bb-d60cbaf38545"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reached termination condition, returning Esurf:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}],
  SequenceForm["Reached termination condition, returning Esurf:", {3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.8728483269542217`*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"84266333-6f74-4397-a57c-946f3a332b65"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Complete term returned at this level: \"\>", 
   "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "1", "]"}], "+", 
       RowBox[{"OSE", "[", "2", "]"}], "+", 
       RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "3", "]"}], "+", 
       RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}],
  SequenceForm[
  "Complete term returned at this level: ", ($CellContext`OSE[
      1] + $CellContext`OSE[2] + $CellContext`OSE[4])^(-1)/($CellContext`OSE[
    3] + $CellContext`OSE[4])],
  Editable->False]], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.87284832695756*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"8125c515-5a48-4872-8eaa-54263f4888b1"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{3.872839419838751*^9, 3.872839548038484*^9, 
  3.872840264941155*^9, 3.872840320179619*^9, 3.8728405868277693`*^9, 
  3.872840656056155*^9, 3.8728483269606857`*^9},
 CellLabel->
  "During evaluation of \
In[814]:=",ExpressionUUID->"b4e17478-6daa-4bb8-9590-e3bdc19520ac"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"True", ",", "True", ",", "False", ",", "True"}], "}"}], ",", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "2", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OSE", "[", "3", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}], ")"}]}]]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{3.8728394201211443`*^9, 3.872839548445241*^9, 
  3.87284026509929*^9, 3.8728403203290854`*^9, 3.872840586987959*^9, 
  3.872840656456547*^9, 3.872848326963846*^9},
 CellLabel->
  "Out[814]=",ExpressionUUID->"331ad853-6c18-436c-b0b2-2e3e1a21a3d9"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DoubleTriangle2L", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872678248328179*^9, 3.87267825122709*^9}, {3.87279670170677*^9, 
  3.872796729672701*^9}, {3.8727967652077217`*^9, 
  3.872796767707892*^9}},ExpressionUUID->"1eb49525-a8c1-4c8b-a25a-\
526799bd79a8"],

Cell[CellGroupData[{

Cell["no external, no masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 
  3.8727969090820427`*^9}},ExpressionUUID->"127a6db8-05e4-4129-8596-\
c63542174ac7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DoubleTriangle2L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "4", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "3", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "4", ",", "5"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DoubleTriangle2L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"DoubleTriangle2L", ",", 
      RowBox[{"masses", "->", 
       RowBox[{"<|", "|>"}]}], ",", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "375"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872796776090105*^9, 3.8727968245116453`*^9}, {3.8727975919505672`*^9, 
  3.8727975954485188`*^9}, {3.872797648438586*^9, 3.872797674079562*^9}, {
  3.8728382574094467`*^9, 3.872838257599929*^9}, {3.872839075053714*^9, 
  3.872839129764516*^9}, {3.872848349857049*^9, 3.872848351757959*^9}},
 CellLabel->
  "In[815]:=",ExpressionUUID->"1e0219a9-bc2a-4449-8049-297308886fb3"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 
      4}, {{{1, 2}, {2, 3}, {1, 4}, {4, 3}, {2, 4}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 4, "sig" -> {{0, -1}, {}}, "mass" -> 0|>, <|
        "id" -> 5, "sig" -> {{1, -1}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 375}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 3.}, {1., 2.}}, 0.030239520958083826`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQjQo4HGCskPM3jr6ezw7nb/KQrNhliuCL5xwUyznI
Bue3WV5cyOCM4P/dANLACufXXVKvvaSO4HPMyzvL380C588UluUyeMIM55sY
gwCCfwWkvZYJzi+UOQ5EjHC+kCAIIPgbWaM3sEYzwPkLvnjO/+L53x7Gv3cX
BP7C+bIg4wr/wPkxG0AG/IbzZ80EgZ9wPjh4zH/A+Z8PK6U+ePkNzmcHWb/h
K4IP9u8XOP9rT+yef5Wf4Xxw8NR+gvPByqd8hPMjEv1KNA58gPMh4IM9AIO9
YI0=
          "]], 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0., 2.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQEf7KEMBxh/+byN3dft/9vD+EkTjT6UZP+zZ4Ty
9W406d5o+guX5yle5MzY9gfO/5UI0vAbwV/iD0II9TZ3Z8mL/YTzDdWtRBJO
fIfz08DgG5y/GKz9C5z/2KIPiD7D3aOsBAKf4PKJ3NsSuLd9gPPtX062ezn5
HZy/ZzcIvIbzLUHGPX4B54N0J3A/g/ONweAxnA8OnvwHcP45/u4pjctvw90j
nnNQLOfgNbi8ZMUuU3udS3D+ivQ3j76ePw3nT7EDOfAwnP/g5bU/Gzx2wvn/
tM508rGugPNhMQcApt6NHA==
          "]], 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {1., 0.9999999999999998}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {0., 1.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "5"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {1., 0.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{0., 3.}, 0.030239520958083826], 
        DiskBox[{1., 2.}, 0.030239520958083826], 
        DiskBox[{1., 0.}, 0.030239520958083826], 
        DiskBox[{0., 1.}, 0.030239520958083826]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->375]], "Output",
 CellChangeTimes->{{3.872786282581215*^9, 3.87278629371031*^9}, 
   3.872788848268298*^9, 3.8727951888519077`*^9, {3.872796810473688*^9, 
   3.872796825004677*^9}, 3.8727970720844097`*^9, {3.872797593087082*^9, 
   3.8727975960111837`*^9}, {3.87279764916956*^9, 3.872797674692068*^9}, 
   3.8728245663075123`*^9, {3.872838252345289*^9, 3.872838258204343*^9}, 
   3.8728391306448727`*^9, 3.872840713605142*^9, 3.872848352683721*^9},
 CellLabel->
  "Out[816]=",ExpressionUUID->"af4f9b81-982d-4ca9-802c-528e83afed66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleTriangle2LcLTDexpr", "=", 
  RowBox[{"GeneratecLTDExpression", "[", "DoubleTriangle2L", "]"}]}]], "Input",\

 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727864358378*^9, 3.872786437591256*^9}, {3.872796829782374*^9, 
  3.8727968318114767`*^9}},
 CellLabel->
  "In[817]:=",ExpressionUUID->"ac03b746-84f0-4a66-8742-a04d76133c09"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["4", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}], "3"]]}], "-", 
      FractionBox["2", 
       RowBox[{"E0", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}], "2"]}]], "-", 
      FractionBox["2", 
       RowBox[{"E3", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}], "2"]}]], "-", 
      FractionBox["2", 
       RowBox[{"E0", " ", "E3", " ", 
        RowBox[{"(", 
         RowBox[{"E0", "+", "E2", "+", "E3"}], ")"}]}]]}], 
     RowBox[{"32", " ", 
      SuperscriptBox["E0", "2"], " ", "E2", " ", 
      SuperscriptBox["E3", "2"]}]]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"E0", "\[Rule]", 
      SqrtBox[
       RowBox[{"k1", ".", "k1"}]]}], ",", 
     RowBox[{"E1", "\[Rule]", 
      SqrtBox[
       RowBox[{"k1", ".", "k1"}]]}], ",", 
     RowBox[{"E2", "\[Rule]", 
      SqrtBox[
       RowBox[{
        RowBox[{"k1", ".", "k1"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"k1", ".", "k2"}]}], "+", 
        RowBox[{"k2", ".", "k2"}]}]]}], ",", 
     RowBox[{"E3", "\[Rule]", 
      SqrtBox[
       RowBox[{"k2", ".", "k2"}]]}], ",", 
     RowBox[{"E4", "\[Rule]", 
      SqrtBox[
       RowBox[{"k2", ".", "k2"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786318624598*^9, 3.8727864555233927`*^9, 
  3.872788856792451*^9, 3.8727951891224527`*^9, 3.872796832681644*^9, 
  3.872797072350286*^9, 3.872838267858527*^9, 3.8728391344927397`*^9, 
  3.872840713941723*^9, 3.872848355446144*^9},
 CellLabel->
  "Out[817]=",ExpressionUUID->"f1401212-3bb8-4e71-9edb-9221b9cfb40e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleTriangle2Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"DoubleTriangle2L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.8727864421208963`*^9}, {
  3.8727968356803703`*^9, 3.872796837729765*^9}},
 CellLabel->
  "In[818]:=",ExpressionUUID->"b42db903-a0f0-410e-bed0-9e69f1e446e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727864579020023`*^9, 
  3.872788860838923*^9, 3.872795189139636*^9, 3.872796838705688*^9, 
  3.872797072397326*^9, 3.872840714013406*^9, 3.8728483570807343`*^9},
 CellLabel->
  "Out[818]=",ExpressionUUID->"fb7cf2f9-a183-4fba-b1c7-a5d4068c33e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleTriangle2LcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "DoubleTriangle2L", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
  3.8727901475343237`*^9, 3.8727901484026947`*^9}, {3.8727971695359497`*^9, 
  3.872797171423841*^9}},
 CellLabel->
  "In[819]:=",ExpressionUUID->"a62a1ff3-2bd3-40c0-8f2d-e216d7d253ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"DoubleTriangle2LcLTDexpr", ",", "DoubleTriangle2Lnumerics"}], 
    "]"}], "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872790160242073*^9, 3.872790165934816*^9}, {
   3.8727969927487087`*^9, 3.87279699363657*^9}, {3.872797026132416*^9, 
   3.872797029241851*^9}, {3.872797176299097*^9, 3.872797179288602*^9}},
 CellLabel->
  "In[820]:=",ExpressionUUID->"552c5c35-720b-4dfe-90ed-029c4c4bd6ec"],

Cell[BoxData[
 TagBox[
  StyleBox["0.06293878695290056`",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.872797181057626*^9, 3.872826489355402*^9, 
  3.8728382940172577`*^9, 3.872840714273872*^9, 3.872848359115456*^9},
 CellLabel->
  "Out[820]//FullForm=",ExpressionUUID->"41700dc6-7f1f-479c-98b4-\
1e2951b7b8ab"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleTriangle2LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"DoubleTriangle2L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, 
   3.8727947613375397`*^9, 3.8727948931357603`*^9, {3.872797111531693*^9, 
   3.872797113331418*^9}},
 CellLabel->
  "In[821]:=",ExpressionUUID->"b6985f63-a47a-4bd0-9b59-12cdcdc1089b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{
    "DoubleTriangle2L", ",", "DoubleTriangle2LcFFexpr", ",", 
     "DoubleTriangle2Lnumerics"}], "]"}], "//", "N"}], "//", 
  "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
   3.872790175456388*^9, 3.8727901759693403`*^9}, 3.872791429962783*^9, {
   3.872797114945732*^9, 3.8727971220428133`*^9}},
 CellLabel->
  "In[823]:=",ExpressionUUID->"2d140f4f-6d5a-438c-a858-91602cacc35c"],

Cell[BoxData[
 TagBox[
  StyleBox["0.06293878695290056`",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.872797124655748*^9, 3.872826481706263*^9, 
  3.872840714443472*^9, 3.872848371896535*^9},
 CellLabel->
  "Out[823]//FullForm=",ExpressionUUID->"c1898260-bc57-48f0-8c02-\
f4a4585112fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrossFreeFamilyLTD", "[", 
  RowBox[{"DoubleTriangle2L", ",", 
   RowBox[{"ConvertToNormalisedFormat", "->", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Orientations", "->", 
    RowBox[{"{", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"o", "===", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", 
         RowBox[{
          RowBox[{
          "DoubleTriangle2LcFFexpr", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "[", "\"\<Orientation\>\"", "]"}]}], 
        "}"}]}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"DEBUG", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87282418927404*^9, 3.872824219144011*^9}, {
  3.872824254878398*^9, 3.8728242581442204`*^9}},
 CellLabel->
  "In[824]:=",ExpressionUUID->"bb86d352-0ad4-4e55-8764-73ca666a1580"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Now considering orientation: {-1, -1, -1, -1, -1}\"\>"], \
"Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379520843*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"a71adb68-5e55-4005-ab51-8b9c90d543b9"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483795241528`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"7bd1200a-cf37-4ec7-92eb-3b157db1ac12"],

Cell[BoxData["\<\"Now considering the following graph:\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379527384*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"f2cdaff8-0a1d-45a2-b2df-5695e3f5e56f"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{2, 1, 4, 
      3}, {{{1, 2}, {3, 2}, {4, 1}, {3, 1}, {4, 3}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>, <|
        "id" -> 5, "sig" -> {{1, -1}, {}}, "mass" -> 0|>, <|
        "id" -> 4, "sig" -> {{0, -1}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {
        DirectedEdge[3, 2, <|"id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>] -> 
         2, DirectedEdge[
          3, 4, <|"id" -> 4, "sig" -> {{0, -1}, {}}, "mass" -> 0|>] -> 4, 
         DirectedEdge[
          4, 1, <|"id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>] -> 3, 
         DirectedEdge[
          2, 1, <|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>] -> 1, 
         DirectedEdge[
          4, 2, <|"id" -> 5, "sig" -> {{1, -1}, {}}, "mass" -> 0|>] -> 5}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 1.}, {1., 0.}}, 0.030239520958083826`], 
         InsetBox["1", {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {0., 1.}}, 0.030239520958083826`], 
         InsetBox["5", {0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQEf7KEMBxh/+byN3dft/9vD+EkTjT6UZP+zZ4Ty
9W406d5o+guX5yle5MzY9gfO/5UI0vAbwV/iD0II9TZ3Z8mL/YTzDdWtRBJO
fIfz08DgG5y/GKz9C5z/2KIPiD7D3aOsBAKf4PKJ3NsSuLd9gPPtX062ezn5
HZy/ZzcIvIbzLUHGPX4B54N0J3A/g/ONweAxnA8OnvwHcP45/u4pjctvw90j
nnNQLOfgNbi8ZMUuU3udS3D+ivQ3j76ePw3nT7EDOfAwnP/g5bU/Gzx2wvn/
tM508rGugPNhMQcApt6NHA==
          "]], 0.030239520958083826`], 
         InsetBox["3", {1., 0.9999999999999998}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQjQo4HGCskPM3jr6ezw7nb/KQrNhliuCL5xwUyznI
Bue3WV5cyOCM4P/dANLACufXXVKvvaSO4HPMyzvL380C588UluUyeMIM55sY
gwCCfwWkvZYJzi+UOQ5EjHC+kCAIIPgbWaM3sEYzwPkLvnjO/+L53x7Gv3cX
BP7C+bIg4wr/wPkxG0AG/IbzZ80EgZ9wPjh4zH/A+Z8PK6U+ePkNzmcHWb/h
K4IP9u8XOP9rT+yef5Wf4Xxw8NR+gvPByqd8hPMjEv1KNA58gPMh4IM9AIO9
YI0=
          "]], 0.030239520958083826`], 
         InsetBox["2", {0., 2.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 3.}, {1., 2.}}, 0.030239520958083826`], 
         InsetBox["4", {0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 1.}, 0.030239520958083826], 
         InsetBox["2", 
          Offset[{2, 2}, {0.030239520958083826, 1.030239520958084}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.030239520958083826], 
         InsetBox["1", 
          Offset[{2, 2}, {1.030239520958084, 0.030239520958083826}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 2.}, 0.030239520958083826], 
         InsetBox["4", 
          Offset[{2, 2}, {1.030239520958084, 2.0302395209580837}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 3.}, 0.030239520958083826], 
         InsetBox["3", 
          Offset[{2, 2}, {0.030239520958083826, 3.0302395209580837}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379614561*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"7a48ff40-1776-427d-b246-977ed795e348"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Found the following sources (first one will be considered): \"\
\>", "\[InvisibleSpace]", 
   RowBox[{"{", "3", "}"}]}],
  SequenceForm[
  "Found the following sources (first one will be considered): ", {3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379622137*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"e0fa0aa4-2164-41b3-b811-101f7ac265a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges to be contracted (possibly won't contribute all): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm[
  "Edges to be contracted (possibly won't contribute all): ", {2, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379625104*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"571d6b78-5b9d-4122-b2f1-b8bbd76e674e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Contributing edge contractions: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    TemplateBox[{"3", "4", 
      RowBox[{"\[LeftAssociation]", 
        RowBox[{
          RowBox[{"\"id\"", "\[Rule]", "4"}], ",", 
          RowBox[{"\"sig\"", "\[Rule]", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
          RowBox[{"\"mass\"", "\[Rule]", "0"}]}], "\[RightAssociation]"}]},
     "DirectedEdge"], "}"}]}],
  SequenceForm["Contributing edge contractions: ", {
    DirectedEdge[3, 4, <|"id" -> 4, "sig" -> {{0, -1}, {}}, "mass" -> 0|>]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379628003*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"15bf748c-31ba-493e-beaa-104f28896355"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Esurf for this term: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}],
  SequenceForm["Esurf for this term: ", {2, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483796321697`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"5e28d82e-3a69-4e42-ae15-c6e15c6d7d49"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483796352997`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"1a8a24af-1879-4b19-b474-a660d99d749f"],

Cell[BoxData["\<\"Now considering the following graph:\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483796385927`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"fc5bee27-005e-4a4f-94d6-684216af92a4"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{2, 1, 
      4}, {{{1, 2}, {3, 2}, {3, 1}, {3, 1}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>, <|
        "id" -> 5, "sig" -> {{1, -1}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {
        DirectedEdge[4, 2, <|"id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>] -> 
         2, DirectedEdge[
          4, 1, <|"id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>] -> 3, 
         DirectedEdge[
          2, 1, <|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>] -> 1, 
         DirectedEdge[
          4, 2, <|"id" -> 5, "sig" -> {{1, -1}, {}}, "mass" -> 0|>] -> 5}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 1.}, {1., 0.}}, 0.02261146496815286], 
         InsetBox["1", {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1., 2.}, {0.6644407471831262, 
          1.3355592528168927`}, {0., 1.}}], 0.02261146496815286], 
         InsetBox["2", {0.5700000000000002, 1.4300000000000002}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1., 2.}, {0.3355592528168884, 
          1.6644407471831248`}, {0., 1.}}], 0.02261146496815286], 
         InsetBox["5", {0.42999999999999994, 1.57}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQEf7KEMBxh/+byN3dft/9vD+EkTjT6UZP+zZ4Ty
9W406d5o+guX5yle5MzY9gfO/5UI0vAbwV/iD0II9TZ3Z8mL/YTzDdWtRBJO
fIfz08DgG5y/GKz9C5z/2KIPiD7D3aOsBAKf4PKJ3NsSuLd9gPPtX062ezn5
HZy/ZzcIvIbzLUHGPX4B54N0J3A/g/ONweAxnA8OnvwHcP45/u4pjctvw90j
nnNQLOfgNbi8ZMUuU3udS3D+ivQ3j76ePw3nT7EDOfAwnP/g5bU/Gzx2wvn/
tM508rGugPNhMQcApt6NHA==
          "]], 0.02261146496815286], 
         InsetBox["3", {1., 0.9999999999999998}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 1.}, 0.02261146496815286], 
         InsetBox["2", 
          Offset[{2, 2}, {0.02261146496815286, 1.0226114649681528}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.02261146496815286], 
         InsetBox["1", 
          Offset[{2, 2}, {1.0226114649681528, 0.02261146496815286}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 2.}, 0.02261146496815286], 
         InsetBox["4", 
          Offset[{2, 2}, {1.0226114649681528, 2.022611464968153}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379737439*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"7d677c2b-f26f-46d9-99f0-b40af0d57683"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Found the following sources (first one will be considered): \"\
\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm[
  "Found the following sources (first one will be considered): ", {4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.87284837974547*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"7ab87d1f-0307-4c33-8983-9be25f3c6efb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Edges to be contracted (possibly won't contribute all): \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}]}],
  SequenceForm[
  "Edges to be contracted (possibly won't contribute all): ", {3, 2, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483797490873`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"2e5bd53c-0f79-4d45-a5bd-78584edfdfb5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Contributing edge contractions: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    TemplateBox[{"4", "2", 
      RowBox[{"\[LeftAssociation]", 
        RowBox[{
          RowBox[{"\"id\"", "\[Rule]", "2"}], ",", 
          RowBox[{"\"sig\"", "\[Rule]", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], ",", 
          RowBox[{"\"mass\"", "\[Rule]", "0"}]}], "\[RightAssociation]"}]},
     "DirectedEdge"], "}"}]}],
  SequenceForm["Contributing edge contractions: ", {
    DirectedEdge[4, 2, <|"id" -> 2, "sig" -> {{0, 1}, {}}, "mass" -> 0|>]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379752543*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"b333c897-b05d-4007-b2ef-388bb81ed0ef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Esurf for this term: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}]}],
  SequenceForm["Esurf for this term: ", {3, 2, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379757247*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"7a628427-093b-49da-a66e-98ec1eb89d28"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379761829*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"f997bffb-d0d3-4131-bb13-9405e13e5391"],

Cell[BoxData["\<\"Now considering the following graph:\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379765439*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"8a309442-b49b-4fd9-ad3f-bd64b8eb2e4e"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{2, 
      1}, {{{1, 2}, {1, 2}}, 
       Null, {<|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>, <|
        "id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>}}, {
      EdgeLabels -> {
        DirectedEdge[
          2, 1, <|"id" -> 3, "sig" -> {{-1, 0}, {}}, "mass" -> 0|>] -> 3, 
         DirectedEdge[
          2, 1, <|"id" -> 1, "sig" -> {{1, 0}, {}}, "mass" -> 0|>] -> 1}, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[BezierCurveBox[{{1., 0.}, {
          0.5000000000000006, -0.16444074718311627`}, {0., 
          1.2246467991473532`*^-16}}], 0.01273], 
         InsetBox["1", {0.5000000000000001, -0.07}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1., 0.}, {0.5000000000000001, 
          0.16444074718311646`}, {0., 1.2246467991473532`*^-16}}], 0.01273], 
         InsetBox["3", {0.5000000000000001, 0.07000000000000012}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{1., 0.}, 0.01273], 
         InsetBox["2", Offset[{2, 2}, {1.01273, 0.01273}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0., 1.2246467991473532*^-16}, 0.01273], 
         InsetBox["1", Offset[{2, 2}, {0.01273, 0.012730000000000123}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483798534737`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"534df56f-79a7-4c2b-b9b3-6b63a2508c82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reached termination condition, returning Esurf:\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}],
  SequenceForm["Reached termination condition, returning Esurf:", {1, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379858753*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"893354e3-387b-47ce-b5c2-583120354fa8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Complete term returned at this level: \"\>", 
   "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "1", "]"}], "+", 
       RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "2", "]"}], "+", 
       RowBox[{"OSE", "[", "3", "]"}], "+", 
       RowBox[{"OSE", "[", "5", "]"}]}], ")"}]}]]}],
  SequenceForm[
  "Complete term returned at this level: ", ($CellContext`OSE[
      1] + $CellContext`OSE[3])^(-1)/($CellContext`OSE[2] + $CellContext`OSE[
    3] + $CellContext`OSE[5])],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.8728483798615417`*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"a62e2414-4a42-415e-be08-cb84063cd5cd"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.872848379864154*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"daa89537-989a-4e09-83c2-73605e01dadf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Complete term returned at this level: \"\>", 
   "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "1", "]"}], "+", 
       RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "2", "]"}], "+", 
       RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"OSE", "[", "2", "]"}], "+", 
       RowBox[{"OSE", "[", "3", "]"}], "+", 
       RowBox[{"OSE", "[", "5", "]"}]}], ")"}]}]]}],
  SequenceForm[
  "Complete term returned at this level: ", ($CellContext`OSE[
      1] + $CellContext`OSE[3])^(-1) ($CellContext`OSE[2] + $CellContext`OSE[
      4])^(-1)/($CellContext`OSE[2] + $CellContext`OSE[3] + $CellContext`OSE[
    5])],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.87284837986755*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"8b617b2e-3176-450a-a945-18e817908ca9"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8728242585582933`*^9, 3.8728242980443172`*^9, 3.872824409423892*^9, 
   3.8728244466613283`*^9, 3.872824511177853*^9, 3.872824568957045*^9, 
   3.872824624778223*^9, 3.872825059467052*^9, 3.872825114056505*^9, 
   3.872825151445449*^9, {3.872825238287116*^9, 3.872825273941699*^9}, 
   3.872825735997635*^9, 3.872825848131092*^9, {3.8728264154494257`*^9, 
   3.872826475165552*^9}, 3.872838496900249*^9, 3.872840714548317*^9, 
   3.87284837987202*^9},
 CellLabel->
  "During evaluation of \
In[824]:=",ExpressionUUID->"fd788caf-e474-4a25-a306-fc1589031bff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
     "}"}], ",", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OSE", "[", "1", "]"}], "+", 
        RowBox[{"OSE", "[", "3", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OSE", "[", "2", "]"}], "+", 
        RowBox[{"OSE", "[", "4", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OSE", "[", "2", "]"}], "+", 
        RowBox[{"OSE", "[", "3", "]"}], "+", 
        RowBox[{"OSE", "[", "5", "]"}]}], ")"}]}]]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.8728242202219048`*^9, 3.87282425871587*^9, 3.872824298154169*^9, 
   3.872824409497615*^9, 3.87282444704384*^9, 3.8728245116033297`*^9, 
   3.872824569325879*^9, 3.872824625153591*^9, 3.872825059980201*^9, 
   3.8728251145768137`*^9, 3.872825151825035*^9, {3.8728252390740232`*^9, 
   3.8728252743584642`*^9}, 3.872825736417996*^9, 3.87282584860763*^9, {
   3.872826415837468*^9, 3.872826475374448*^9}, 3.872838497423978*^9, 
   3.872840715091405*^9, 3.8728483798767014`*^9},
 CellLabel->
  "Out[824]=",ExpressionUUID->"54261746-ee08-424f-90f5-60a9ff0457dd"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DoubleBox2L", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872678248328179*^9, 
  3.87267825122709*^9}},ExpressionUUID->"e6a620a0-e2f5-4f64-a657-\
2e55a61fa9c5"],

Cell[CellGroupData[{

Cell["no external, with masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 3.8727969090820427`*^9}, {
  3.8728484006426563`*^9, 
  3.8728484014055033`*^9}},ExpressionUUID->"53263628-3c39-4ec5-880b-\
55992f2b2424"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DoubleBox2L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "5", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"5", ",", "6", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "4", ",", "5"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "5", ",", "6"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "6", ",", "7"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DoubleBox2L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"DoubleBox2L", ",", "\[IndentingNewLine]", 
      RowBox[{"masses", "->", 
       RowBox[{"Association", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "[", "7", "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872840825362055*^9, 3.8728408275268297`*^9}, {3.8728408656787767`*^9, 
  3.8728408984881783`*^9}},
 CellLabel->
  "In[825]:=",ExpressionUUID->"89de0412-260e-47a7-911f-446cd7618cdc"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 
      6}, {{{1, 2}, {2, 3}, {4, 5}, {5, 6}, {1, 4}, {2, 5}, {3, 6}}, 
       Null, {<|"id" -> 1, "sig" -> {{-1, 0}, {}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{-1, -1}, {}}, "mass" -> 2|>, <|
        "id" -> 3, "sig" -> {{1, 0}, {}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{1, 1}, {}}, "mass" -> 4|>, <|
        "id" -> 5, "sig" -> {{1, 0}, {}}, "mass" -> 5|>, <|
        "id" -> 6, "sig" -> {{0, 1}, {}}, "mass" -> 6|>, <|
        "id" -> 7, "sig" -> {{-1, -1}, {}}, "mass" -> 7|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 600}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 3.}, {0., 2.}}, 0.030239520958083826`], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "1"}]}], 
           "\[RightAssociation]"}], {0., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 3.}, {1., 2.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "5"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "5"}]}], 
           "\[RightAssociation]"}], {0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {0., 1.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "2"}]}], 
           "\[RightAssociation]"}], {0., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {1., 1.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "6"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "6"}]}], 
           "\[RightAssociation]"}], {0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {0., 0.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "7"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "7"}]}], 
           "\[RightAssociation]"}], {0., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {1., 1.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "3"}]}], 
           "\[RightAssociation]"}], {1., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 1.}, {0., 0.}}, 0.030239520958083826`], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "4"}]}], 
           "\[RightAssociation]"}], {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{0., 3.}, 0.030239520958083826], 
        DiskBox[{0., 2.}, 0.030239520958083826], 
        DiskBox[{0., 1.}, 0.030239520958083826], 
        DiskBox[{1., 2.}, 0.030239520958083826], 
        DiskBox[{1., 1.}, 0.030239520958083826], 
        DiskBox[{0., 0.}, 0.030239520958083826]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{{3.872786282581215*^9, 3.87278629371031*^9}, 
   3.872788848268298*^9, 3.8727951888519077`*^9, 3.872797220264071*^9, 
   3.872840730298057*^9, {3.8728408798307858`*^9, 3.87284089885637*^9}, 
   3.872848418005249*^9},
 CellLabel->
  "Out[826]=",ExpressionUUID->"ffd1ecaa-456d-4459-b4bc-c62746900a46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleBox2Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"DoubleBox2L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.8727864421208963`*^9}},
 CellLabel->
  "In[827]:=",ExpressionUUID->"8e9a0ccf-d421-4f9a-9bf9-97d1d7735cc9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727864579020023`*^9, 
  3.872788860838923*^9, 3.872795189139636*^9, 3.872797220391667*^9, 
  3.872840730462865*^9, 3.8728409021555433`*^9, 3.8728484181363897`*^9},
 CellLabel->
  "Out[827]=",ExpressionUUID->"6b7d55ed-a50c-455b-bae7-70b77781c091"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleBox2LcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "DoubleBox2L", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
   3.8727864358378*^9, 3.872786437591256*^9}, 3.872840907043681*^9},
 CellLabel->
  "In[828]:=",ExpressionUUID->"ddb44adf-eefa-45ea-bc96-8a5bf5b37e35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"DoubleBox2LcLTDexpr", ",", "DoubleBox2Lnumerics"}], "]"}], "//", 
   "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872786449572639*^9, 3.872786482717091*^9}},
 CellLabel->
  "In[829]:=",ExpressionUUID->"f074a865-04a2-40bb-9ad7-1ddf818e24a1"],

Cell[BoxData[
 TagBox[
  StyleBox["1.176939570544602`*^-9",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.87278618513922*^9, 3.872786381566922*^9, 3.872786419209247*^9, {
   3.872786459981874*^9, 3.8727864829328117`*^9}, 3.872788864920912*^9, 
   3.872788906268878*^9, 3.8727951891905403`*^9, 3.872796510870987*^9, 
   3.8727972205831957`*^9, 3.8728407308166103`*^9, 3.872840909341104*^9, 
   3.872848418453405*^9},
 CellLabel->
  "Out[829]//FullForm=",ExpressionUUID->"111fc611-fc81-4f66-8133-\
b85b4bb0b2c7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleBox2LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"DoubleBox2L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, {
  3.8727888881603937`*^9, 3.8727888911094017`*^9}, {3.8727959440856867`*^9, 
  3.872795996075848*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"a7376605-dfc0-4cf5-8426-69c44e2b45f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{
    "DoubleBox2L", ",", "DoubleBox2LcFFexpr", ",", "DoubleBox2Lnumerics"}], 
    "]"}], "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
  3.872788895692417*^9, 3.872788932313096*^9}, {3.8727889780565233`*^9, 
  3.872788978424065*^9}, {3.872789530328937*^9, 3.872789540646806*^9}, {
  3.872789585296913*^9, 3.872789585445369*^9}, {3.8728409139186287`*^9, 
  3.872840916308522*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"718fa2ae-e07a-4295-90f6-51bf65514204"],

Cell[BoxData[
 TagBox[
  StyleBox["1.176939570544602`*^-9",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.8727889134417877`*^9, 3.872788932734542*^9}, 
   3.872788978921811*^9, {3.872789531877469*^9, 3.872789540987729*^9}, 
   3.872789585892194*^9, 3.8727951896750526`*^9, 3.872795940811214*^9, {
   3.8727959932405987`*^9, 3.872795997672605*^9}, 3.872796515757333*^9, 
   3.872796617173212*^9, 3.872797221217608*^9, 3.8728407316293573`*^9, 
   3.872840916619995*^9, 3.872848419036895*^9},
 CellLabel->
  "Out[831]//FullForm=",ExpressionUUID->"97ca3e65-b67d-4603-821d-\
ce322f05b687"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["with masses, with externals", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 3.8727969090820427`*^9}, {
   3.8728484006426563`*^9, 3.8728484014055033`*^9}, {3.872848434418722*^9, 
   3.872848436583297*^9}, 
   3.872848567017826*^9},ExpressionUUID->"0f13eb4e-a956-4257-8996-\
2ed2d1b53fb9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DoubleBox2L", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "5", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"5", ",", "6", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "4", ",", "5"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "5", ",", "6"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "6", ",", "7"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"101", ",", "1", ",", "8"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"102", ",", "4", ",", "8"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"103", ",", "3", ",", "8"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"104", ",", "6", ",", "8"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DoubleBox2L", "=", 
  RowBox[{"DirectedGraph", "[", 
   RowBox[{
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"DoubleBox2L", ",", "\[IndentingNewLine]", 
      RowBox[{"masses", "->", 
       RowBox[{"Association", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "[", "7", "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"5", ",", "6"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"EdgeLabels", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872840825362055*^9, 3.8728408275268297`*^9}, {3.8728408656787767`*^9, 
  3.8728408984881783`*^9}, {3.872848440571299*^9, 3.8728485300554113`*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"c260b5ce-3986-475e-bc99-3a51fdfd0075"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 101, 102, 103, 
      104}, {{{1, 2}, {2, 3}, {4, 5}, {5, 6}, {1, 4}, {2, 5}, {3, 6}, {7, 
       1}, {8, 4}, {9, 3}, {10, 6}}, 
       Null, {<|"id" -> 1, "sig" -> {{-1, 0}, {1, 0, 0, 0}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{-1, -1}, {1, 0, 0, 0}}, "mass" -> 2|>, <|
        "id" -> 3, "sig" -> {{1, 0}, {-1, 0, -1, -1}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{1, 1}, {-1, 0, -1, -1}}, "mass" -> 4|>, <|
        "id" -> 5, "sig" -> {{1, 0}, {0, 0, 0, 0}}, "mass" -> 5|>, <|
        "id" -> 6, "sig" -> {{0, 1}, {0, 0, 0, 0}}, "mass" -> 6|>, <|
        "id" -> 7, "sig" -> {{-1, -1}, {1, 0, 1, 0}}, "mass" -> 7|>, <|
        "id" -> 8, "sig" -> {{0, 0}, {1, 0, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 8, "sig" -> {{0, 0}, {0, 1, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 8, "sig" -> {{0, 0}, {0, 0, 1, 0}}, "mass" -> 0|>, <|
        "id" -> 8, "sig" -> {{0, 0}, {0, 0, 0, 1}}, "mass" -> 0|>}}, {
      EdgeLabels -> {Automatic}, ImageSize -> 600, 
       VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 3.}, {0., 2.}}, 0.03700564971751412], 
         InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "1"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "1"}]}], 
           "\[RightAssociation]"}], {0., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 3.}, {1., 2.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "5"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "5"}]}], 
           "\[RightAssociation]"}], {0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {-1., 1.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "2"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "2"}]}], 
           "\[RightAssociation]"}], {-0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {0., 1.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "6"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "6"}]}], 
           "\[RightAssociation]"}], {0., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-1., 1.}, {-1., 0.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "7"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "7"}]}], 
           "\[RightAssociation]"}], {-1., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {0., 1.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "3"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "3"}]}], 
           "\[RightAssociation]"}], {0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {-1., 0.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "4"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "4"}]}], 
           "\[RightAssociation]"}], {-0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 4.}, {0., 3.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "8"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {0., 3.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 3.}, {1., 2.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "8"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {1., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-1., 2.}, {-1., 1.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "8"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {-1., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-2., 1.}, {-1., 0.}}, 0.03700564971751412], InsetBox[
          RowBox[{"\[LeftAssociation]", 
           RowBox[{
            RowBox[{"\<\"id\"\>", "\[Rule]", "8"}], ",", 
            RowBox[{"\<\"sig\"\>", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
             ",", 
            RowBox[{"\<\"mass\"\>", "\[Rule]", "0"}]}], 
           "\[RightAssociation]"}], {-1.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 3.}, 0.03700564971751412], 
         InsetBox["1", 
          Offset[{2, 2}, {0.03700564971751412, 3.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 2.}, 0.03700564971751412], 
         InsetBox["2", 
          Offset[{2, 2}, {0.03700564971751412, 2.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 1.}, 0.03700564971751412], 
         InsetBox["3", 
          Offset[{2, 2}, {-0.9629943502824859, 1.0370056497175142}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 2.}, 0.03700564971751412], 
         InsetBox["4", 
          Offset[{2, 2}, {1.0370056497175142, 2.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 1.}, 0.03700564971751412], 
         InsetBox["5", 
          Offset[{2, 2}, {0.03700564971751412, 1.0370056497175142}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 0.}, 0.03700564971751412], 
         InsetBox["6", 
          Offset[{2, 2}, {-0.9629943502824859, 0.03700564971751412}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 4.}, 0.03700564971751412], 
         InsetBox["101", 
          Offset[{2, 2}, {0.03700564971751412, 4.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 3.}, 0.03700564971751412], 
         InsetBox["102", 
          Offset[{2, 2}, {1.0370056497175142, 3.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 2.}, 0.03700564971751412], 
         InsetBox["103", 
          Offset[{2, 2}, {-0.9629943502824859, 2.037005649717514}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-2., 1.}, 0.03700564971751412], 
         InsetBox["104", 
          Offset[{2, 2}, {-1.9629943502824858, 1.0370056497175142}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{{3.872786282581215*^9, 3.87278629371031*^9}, 
   3.872788848268298*^9, 3.8727951888519077`*^9, 3.872797220264071*^9, 
   3.872840730298057*^9, {3.8728408798307858`*^9, 3.87284089885637*^9}, 
   3.872848418005249*^9, {3.872848502704067*^9, 3.8728485304700623`*^9}},
 CellLabel->
  "Out[837]=",ExpressionUUID->"cd92ff53-f0df-43c6-907a-ecd0169f874d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DoubleBox2Lnumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"DoubleBox2L", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.8727864421208963`*^9}},
 CellLabel->
  "In[838]:=",ExpressionUUID->"e1edfda4-0909-45c2-8ca3-0c98c87fc65c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}], ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["17", "19"], ",", 
      FractionBox["19", "23"], ",", 
      FractionBox["23", "29"]}], "}"}]}], ",", 
   RowBox[{"p2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["29", "31"], ",", 
      FractionBox["31", "37"], ",", 
      FractionBox["37", "41"]}], "}"}]}], ",", 
   RowBox[{"p3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["41", "43"], ",", 
      FractionBox["43", "47"], ",", 
      FractionBox["47", "53"]}], "}"}]}], ",", 
   RowBox[{"p1E", "\[Rule]", 
    FractionBox["53", "59"]}], ",", 
   RowBox[{"p2E", "\[Rule]", 
    FractionBox["59", "61"]}], ",", 
   RowBox[{"p3E", "\[Rule]", 
    FractionBox["61", "67"]}], ",", 
   RowBox[{"p4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["70503", "25327"]}], ",", 
      RowBox[{"-", 
       FractionBox["103145", "39997"]}], ",", 
      RowBox[{"-", 
       FractionBox["162731", "63017"]}]}], "}"}]}], ",", 
   RowBox[{"p4E", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["669377", "241133"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727864579020023`*^9, 
  3.872788860838923*^9, 3.872795189139636*^9, 3.872797220391667*^9, 
  3.872840730462865*^9, 3.8728409021555433`*^9, 3.8728484181363897`*^9, 
  3.872848535944407*^9},
 CellLabel->
  "Out[838]=",ExpressionUUID->"8f53a872-e68b-47eb-938b-04a7b2862517"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleBox2LcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "DoubleBox2L", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
   3.8727864358378*^9, 3.872786437591256*^9}, 3.872840907043681*^9},
 CellLabel->
  "In[839]:=",ExpressionUUID->"9796279d-b3b4-4668-a4a1-93299869aa78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"DoubleBox2LcLTDexpr", ",", "DoubleBox2Lnumerics"}], "]"}], "//", 
   "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872786449572639*^9, 3.872786482717091*^9}},
 CellLabel->
  "In[840]:=",ExpressionUUID->"30d4b0d6-e80f-4380-b8bb-d3207cc9c560"],

Cell[BoxData[
 TagBox[
  StyleBox["2.2223714932265047`*^-9",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.87278618513922*^9, 3.872786381566922*^9, 3.872786419209247*^9, {
   3.872786459981874*^9, 3.8727864829328117`*^9}, 3.872788864920912*^9, 
   3.872788906268878*^9, 3.8727951891905403`*^9, 3.872796510870987*^9, 
   3.8727972205831957`*^9, 3.8728407308166103`*^9, 3.872840909341104*^9, 
   3.872848418453405*^9, 3.872848538975627*^9},
 CellLabel->
  "Out[840]//FullForm=",ExpressionUUID->"8b042522-bbd6-4d92-bc00-\
04d1156c0e02"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoubleBox2LcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"DoubleBox2L", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, {
  3.8727888881603937`*^9, 3.8727888911094017`*^9}, {3.8727959440856867`*^9, 
  3.872795996075848*^9}},
 CellLabel->
  "In[885]:=",ExpressionUUID->"8751a6b8-75e6-4a3f-a830-c9666b11708a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{
    "DoubleBox2L", ",", "DoubleBox2LcFFexpr", ",", "DoubleBox2Lnumerics"}], 
    "]"}], "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
  3.872788895692417*^9, 3.872788932313096*^9}, {3.8727889780565233`*^9, 
  3.872788978424065*^9}, {3.872789530328937*^9, 3.872789540646806*^9}, {
  3.872789585296913*^9, 3.872789585445369*^9}, {3.8728409139186287`*^9, 
  3.872840916308522*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"b35aaf7d-8a73-4ee8-9804-1c0f98370738"],

Cell[BoxData[
 TagBox[
  StyleBox["2.2223714932265047`*^-9",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.8727889134417877`*^9, 3.872788932734542*^9}, 
   3.872788978921811*^9, {3.872789531877469*^9, 3.872789540987729*^9}, 
   3.872789585892194*^9, 3.8727951896750526`*^9, 3.872795940811214*^9, {
   3.8727959932405987`*^9, 3.872795997672605*^9}, 3.872796515757333*^9, 
   3.872796617173212*^9, 3.872797221217608*^9, 3.8728407316293573`*^9, 
   3.872840916619995*^9, 3.872848419036895*^9, 3.87284854188657*^9},
 CellLabel->
  "Out[842]//FullForm=",ExpressionUUID->"93c9ad99-2ed9-4713-9568-\
39441ab07cae"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["2x2 Fishnet", "Subsection",
 CellChangeTimes->{{3.8726008213245487`*^9, 3.872600852313833*^9}, {
  3.872678248328179*^9, 3.87267825122709*^9}, {3.872848553016901*^9, 
  3.872848558351884*^9}},ExpressionUUID->"ed563676-8a6d-4cbd-8886-\
1e86c9133a15"],

Cell[CellGroupData[{

Cell["with external, with masses", "Subsubsection",
 CellChangeTimes->{{3.872796895443802*^9, 3.8727969090820427`*^9}, {
  3.8728484006426563`*^9, 3.8728484014055033`*^9}, {3.872848564177177*^9, 
  3.8728485646681023`*^9}},ExpressionUUID->"e032fa89-33c8-4b87-9f40-\
9679a725a2e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myGraph", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "3", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "5", ",", "3"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"5", ",", "6", ",", "4"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"7", ",", "8", ",", "5"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"8", ",", "9", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"1", ",", "4", ",", "7"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"2", ",", "5", ",", "8"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"3", ",", "6", ",", "9"}], "]"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"4", ",", "7", ",", "10"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"5", ",", "8", ",", "11"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"6", ",", "9", ",", "12"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"101", ",", "1", ",", "13"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"102", ",", "3", ",", "14"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"103", ",", "7", ",", "15"}], "]"}], ",", 
       RowBox[{"DirectedEdge", "[", 
        RowBox[{"104", ",", "9", ",", "16"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"EdgeLabels", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGraph", "=", 
   RowBox[{"DirectedGraph", "[", 
    RowBox[{"AssignSignatures", "[", 
     RowBox[{"myGraph", ",", "\[IndentingNewLine]", 
      RowBox[{"masses", "->", 
       RowBox[{"Association", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "->", "i"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "[", "12", "]"}]}], "}"}]}], "]"}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"lmb", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}]}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DirectedGraph", "[", 
  RowBox[{"myGraph", ",", 
   RowBox[{"VertexLabels", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"EdgeLabels", "\[Rule]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"e", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"e", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"_", ",", "_", ",", "props_"}], "]"}], ":>", "props"}], 
            "}"}]}], ")"}], "[", "\"\<id\>\"", "]"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"e", ",", 
        RowBox[{"EdgeList", "[", "myGraph", "]"}]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8727862794755*^9, 3.8727862930870867`*^9}, {
  3.872840825362055*^9, 3.8728408275268297`*^9}, {3.8728408656787767`*^9, 
  3.8728408984881783`*^9}, {3.872848572983378*^9, 3.872848968920377*^9}, {
  3.872849070396145*^9, 3.872849081211103*^9}, {3.872849238013115*^9, 
  3.872849283824649*^9}, {3.872849328443112*^9, 3.8728493287924433`*^9}, {
  3.872849384941616*^9, 3.872849385291954*^9}, {3.872849419246366*^9, 
  3.872849419856082*^9}, {3.87284946763367*^9, 3.872849489642624*^9}},
 CellLabel->
  "In[876]:=",ExpressionUUID->"158eaf9c-dff7-40e7-b5ad-c350f1c581e7"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 101, 102, 103, 
      104}, {{{1, 2}, {2, 3}, {4, 5}, {5, 6}, {7, 8}, {8, 9}, {1, 4}, {2, 
       5}, {3, 6}, {4, 7}, {5, 8}, {6, 9}, {10, 1}, {11, 3}, {12, 7}, {13, 
       9}}, Null, {<|
        "id" -> 1, "sig" -> {{1, 0, 0, 0}, {0, 0, 0, 0}}, "mass" -> 1|>, <|
        "id" -> 2, "sig" -> {{0, 1, 0, 0}, {0, 0, 0, 0}}, "mass" -> 2|>, <|
        "id" -> 3, "sig" -> {{-1, 0, -1, 0}, {1, 0, 1, 0}}, "mass" -> 3|>, <|
        "id" -> 4, "sig" -> {{0, -1, 0, -1}, {1, 0, 1, 0}}, "mass" -> 4|>, <|
        "id" -> 5, "sig" -> {{0, 0, 1, 0}, {0, 0, 0, 0}}, "mass" -> 5|>, <|
        "id" -> 6, "sig" -> {{0, 0, 0, 1}, {0, 0, 0, 0}}, "mass" -> 6|>, <|
        "id" -> 7, "sig" -> {{-1, 0, 0, 0}, {1, 0, 0, 0}}, "mass" -> 7|>, <|
        "id" -> 8, "sig" -> {{1, -1, 0, 0}, {0, 0, 0, 0}}, "mass" -> 8|>, <|
        "id" -> 9, "sig" -> {{0, 1, 0, 0}, {0, 1, 0, 0}}, "mass" -> 9|>, <|
        "id" -> 10, "sig" -> {{0, 0, 1, 0}, {0, 0, -1, 0}}, "mass" -> 10|>, <|
        "id" -> 11, "sig" -> {{0, 0, -1, 1}, {0, 0, 0, 0}}, "mass" -> 11|>, <|
        "id" -> 12, "sig" -> {{0, 0, 0, -1}, {1, 1, 1, 0}}, "mass" -> 12|>, <|
        "id" -> 13, "sig" -> {{0, 0, 0, 0}, {1, 0, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 14, "sig" -> {{0, 0, 0, 0}, {0, 1, 0, 0}}, "mass" -> 0|>, <|
        "id" -> 15, "sig" -> {{0, 0, 0, 0}, {0, 0, 1, 0}}, "mass" -> 0|>, <|
        "id" -> 16, "sig" -> {{0, 0, 0, 0}, {0, 0, 0, 1}}, "mass" -> 0|>}}, {
      EdgeLabels -> {
        DirectedEdge[
          4, 7, <|"id" -> 10, "sig" -> {{0, 0, 1, 0}, {0, 0, -1, 0}}, "mass" -> 
            10|>] -> 10, 
         DirectedEdge[
          6, 9, <|"id" -> 12, "sig" -> {{0, 0, 0, -1}, {1, 1, 1, 0}}, "mass" -> 
            12|>] -> 12, 
         DirectedEdge[
          103, 7, <|
           "id" -> 15, "sig" -> {{0, 0, 0, 0}, {0, 0, 1, 0}}, "mass" -> 0|>] -> 
         15, DirectedEdge[
          1, 4, <|"id" -> 7, "sig" -> {{-1, 0, 0, 0}, {1, 0, 0, 0}}, "mass" -> 
            7|>] -> 7, 
         DirectedEdge[
          5, 6, <|"id" -> 4, "sig" -> {{0, -1, 0, -1}, {1, 0, 1, 0}}, "mass" -> 
            4|>] -> 4, 
         DirectedEdge[
          101, 1, <|
           "id" -> 13, "sig" -> {{0, 0, 0, 0}, {1, 0, 0, 0}}, "mass" -> 0|>] -> 
         13, DirectedEdge[
          3, 6, <|"id" -> 9, "sig" -> {{0, 1, 0, 0}, {0, 1, 0, 0}}, "mass" -> 
            9|>] -> 9, 
         DirectedEdge[
          4, 5, <|"id" -> 3, "sig" -> {{-1, 0, -1, 0}, {1, 0, 1, 0}}, "mass" -> 
            3|>] -> 3, 
         DirectedEdge[
          1, 2, <|"id" -> 1, "sig" -> {{1, 0, 0, 0}, {0, 0, 0, 0}}, "mass" -> 
            1|>] -> 1, 
         DirectedEdge[
          2, 5, <|"id" -> 8, "sig" -> {{1, -1, 0, 0}, {0, 0, 0, 0}}, "mass" -> 
            8|>] -> 8, 
         DirectedEdge[
          8, 9, <|"id" -> 6, "sig" -> {{0, 0, 0, 1}, {0, 0, 0, 0}}, "mass" -> 
            6|>] -> 6, 
         DirectedEdge[
          2, 3, <|"id" -> 2, "sig" -> {{0, 1, 0, 0}, {0, 0, 0, 0}}, "mass" -> 
            2|>] -> 2, 
         DirectedEdge[
          102, 3, <|
           "id" -> 14, "sig" -> {{0, 0, 0, 0}, {0, 1, 0, 0}}, "mass" -> 0|>] -> 
         14, DirectedEdge[
          5, 8, <|"id" -> 11, "sig" -> {{0, 0, -1, 1}, {0, 0, 0, 0}}, "mass" -> 
            11|>] -> 11, 
         DirectedEdge[
          104, 9, <|
           "id" -> 16, "sig" -> {{0, 0, 0, 0}, {0, 0, 0, 1}}, "mass" -> 0|>] -> 
         16, DirectedEdge[
          7, 8, <|"id" -> 5, "sig" -> {{0, 0, 1, 0}, {0, 0, 0, 0}}, "mass" -> 
            5|>] -> 5}, VertexLabels -> {Automatic}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 4.}, {0., 3.}}, 0.043048128342245986`], 
         InsetBox["1", {0., 3.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 4.}, {1., 3.}}, 0.043048128342245986`], 
         InsetBox["7", {0.5, 3.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 3.}, {0., 2.}}, 0.043048128342245986`], 
         InsetBox["2", {0., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 3.}, {1., 2.}}, 0.043048128342245986`], 
         InsetBox["8", {0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 2.}, {0., 1.}}, 0.043048128342245986`], 
         InsetBox["9", {0., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 3.}, {1., 2.}}, 0.043048128342245986`], 
         InsetBox["3", {1., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 3.}, {2., 2.}}, 0.043048128342245986`], 
         InsetBox["10", {1.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {0., 1.}}, 0.043048128342245986`], 
         InsetBox["4", {0.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 2.}, {1., 1.}}, 0.043048128342245986`], 
         InsetBox["11", {1., 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 1.}, {0., 0.}}, 0.043048128342245986`], 
         InsetBox["12", {0., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{2., 2.}, {1., 1.}}, 0.043048128342245986`], 
         InsetBox["5", {1.5, 1.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., 1.}, {0., 0.}}, 0.043048128342245986`], 
         InsetBox["6", {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0., 5.}, {0., 4.}}, 0.043048128342245986`], 
         InsetBox["13", {0., 4.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-1., 3.}, {0., 2.}}, 0.043048128342245986`], 
         InsetBox["14", {-0.5, 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{2., 3.}, {2., 2.}}, 0.043048128342245986`], 
         InsetBox["15", {2., 2.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-1., 1.}, {0., 0.}}, 0.043048128342245986`], 
         InsetBox["16", {-0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 4.}, 0.043048128342245986], 
         InsetBox["1", 
          Offset[{2, 2}, {0.043048128342245986, 4.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 3.}, 0.043048128342245986], 
         InsetBox["2", 
          Offset[{2, 2}, {0.043048128342245986, 3.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 2.}, 0.043048128342245986], 
         InsetBox["3", 
          Offset[{2, 2}, {0.043048128342245986, 2.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 3.}, 0.043048128342245986], 
         InsetBox["4", Offset[{2, 2}, {1.043048128342246, 3.043048128342246}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 2.}, 0.043048128342245986], 
         InsetBox["5", Offset[{2, 2}, {1.043048128342246, 2.043048128342246}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 1.}, 0.043048128342245986], 
         InsetBox["6", 
          Offset[{2, 2}, {0.043048128342245986, 1.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{2., 2.}, 0.043048128342245986], 
         InsetBox["7", Offset[{2, 2}, {2.043048128342246, 2.043048128342246}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 1.}, 0.043048128342245986], 
         InsetBox["8", Offset[{2, 2}, {1.043048128342246, 1.043048128342246}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 0.}, 0.043048128342245986], 
         InsetBox["9", 
          Offset[{2, 2}, {0.043048128342245986, 0.043048128342245986}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 5.}, 0.043048128342245986], 
         InsetBox["101", 
          Offset[{2, 2}, {0.043048128342245986, 5.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 3.}, 0.043048128342245986], 
         InsetBox["102", 
          Offset[{2, 2}, {-0.956951871657754, 3.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{2., 3.}, 0.043048128342245986], 
         InsetBox["103", 
          Offset[{2, 2}, {2.043048128342246, 3.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 1.}, 0.043048128342245986], 
         InsetBox["104", 
          Offset[{2, 2}, {-0.956951871657754, 1.043048128342246}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->600]], "Output",
 CellChangeTimes->{{3.872786282581215*^9, 3.87278629371031*^9}, 
   3.872788848268298*^9, 3.8727951888519077`*^9, 3.872797220264071*^9, 
   3.872840730298057*^9, {3.8728408798307858`*^9, 3.87284089885637*^9}, 
   3.872848418005249*^9, 3.872849001591085*^9, 3.872849081713716*^9, {
   3.8728492415708237`*^9, 3.8728492841938763`*^9}, 3.872849329105851*^9, {
   3.872849385705449*^9, 3.872849387179576*^9}, 3.872849420471342*^9, {
   3.8728494764881144`*^9, 3.8728494903868504`*^9}},
 CellLabel->
  "Out[878]=",ExpressionUUID->"6ca1866b-965d-4391-9d45-47829fd212bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myGraphNumerics", "=", 
  RowBox[{"GenerateRandomSample", "[", 
   RowBox[{"myGraph", ",", 
    RowBox[{"Seed", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.872786406983837*^9, 3.8727864421208963`*^9}, {
  3.87284952630871*^9, 3.872849529857911*^9}},
 CellLabel->
  "In[880]:=",ExpressionUUID->"12c3530c-852d-4b6c-9fe6-7cb034748e71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["2", "3"], ",", 
      FractionBox["3", "5"], ",", 
      FractionBox["5", "7"]}], "}"}]}], ",", 
   RowBox[{"k2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["7", "11"], ",", 
      FractionBox["11", "13"], ",", 
      FractionBox["13", "17"]}], "}"}]}], ",", 
   RowBox[{"k3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["17", "19"], ",", 
      FractionBox["19", "23"], ",", 
      FractionBox["23", "29"]}], "}"}]}], ",", 
   RowBox[{"k4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["29", "31"], ",", 
      FractionBox["31", "37"], ",", 
      FractionBox["37", "41"]}], "}"}]}], ",", 
   RowBox[{"p1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["41", "43"], ",", 
      FractionBox["43", "47"], ",", 
      FractionBox["47", "53"]}], "}"}]}], ",", 
   RowBox[{"p2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["53", "59"], ",", 
      FractionBox["59", "61"], ",", 
      FractionBox["61", "67"]}], "}"}]}], ",", 
   RowBox[{"p3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["67", "71"], ",", 
      FractionBox["71", "73"], ",", 
      FractionBox["73", "79"]}], "}"}]}], ",", 
   RowBox[{"p1E", "\[Rule]", 
    FractionBox["79", "83"]}], ",", 
   RowBox[{"p2E", "\[Rule]", 
    FractionBox["83", "89"]}], ",", 
   RowBox[{"p3E", "\[Rule]", 
    FractionBox["89", "97"]}], ",", 
   RowBox[{"p4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["503537", "180127"]}], ",", 
      RowBox[{"-", 
       FractionBox["597465", "209291"]}], ",", 
      RowBox[{"-", 
       FractionBox["763401", "280529"]}]}], "}"}]}], ",", 
   RowBox[{"p4E", "\[Rule]", 
    RowBox[{"-", 
     FractionBox["2007683", "716539"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.872786415168228*^9, 3.8727864579020023`*^9, 
  3.872788860838923*^9, 3.872795189139636*^9, 3.872797220391667*^9, 
  3.872840730462865*^9, 3.8728409021555433`*^9, 3.8728484181363897`*^9, 
  3.872849531266016*^9, 3.87284957714859*^9},
 CellLabel->
  "Out[880]=",ExpressionUUID->"0eb2e65c-df9e-486a-a981-3e3a001a3232"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGraphcLTDexpr", "=", 
   RowBox[{"GeneratecLTDExpression", "[", "myGraph", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.872786304741543*^9, 3.872786318087468*^9}, {
   3.8727864358378*^9, 3.872786437591256*^9}, 3.872840907043681*^9, {
   3.872849541357629*^9, 3.872849543186041*^9}},
 CellLabel->
  "In[881]:=",ExpressionUUID->"81182dd0-b90f-4111-8d1e-88bb6e9f273e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcLTD", "[", 
    RowBox[{"myGraphcLTDexpr", ",", "myGraphNumerics"}], "]"}], "//", "N"}], "//",
   "FullForm"}]], "Input",
 CellChangeTimes->{{3.872786173988125*^9, 3.8727861844778347`*^9}, 
   3.872786312656372*^9, 3.872786381219412*^9, {3.872786412476543*^9, 
   3.872786418835643*^9}, {3.872786449572639*^9, 3.872786482717091*^9}, {
   3.872849546356292*^9, 3.8728495520923853`*^9}},
 CellLabel->
  "In[882]:=",ExpressionUUID->"2ef7f814-32a4-4209-a480-a7c51cd14b7c"],

Cell[BoxData[
 TagBox[
  StyleBox["3.682931075780109`*^-19",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{
  3.87278618513922*^9, 3.872786381566922*^9, 3.872786419209247*^9, {
   3.872786459981874*^9, 3.8727864829328117`*^9}, 3.872788864920912*^9, 
   3.872788906268878*^9, 3.8727951891905403`*^9, 3.872796510870987*^9, 
   3.8727972205831957`*^9, 3.8728407308166103`*^9, 3.872840909341104*^9, 
   3.872848418453405*^9, 3.872849599056068*^9},
 CellLabel->
  "Out[882]//FullForm=",ExpressionUUID->"a80badce-8cd1-480f-a77b-\
1d2411ef422f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGraphcFFexpr", "=", 
   RowBox[{"CrossFreeFamilyLTD", "[", 
    RowBox[{"myGraph", ",", 
     RowBox[{"ConvertToNormalisedFormat", "->", "True"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.872787600282514*^9, 3.8727876312314*^9}, {
  3.8727888881603937`*^9, 3.8727888911094017`*^9}, {3.8727959440856867`*^9, 
  3.872795996075848*^9}, {3.8728495591227617`*^9, 3.872849564209763*^9}},
 CellLabel->
  "In[888]:=",ExpressionUUID->"7acac116-a411-4d0c-a6a6-181025271d1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvalcFF", "[", 
    RowBox[{"myGraph", ",", "myGraphcFFexpr", ",", "myGraphNumerics"}], "]"}],
    "//", "N"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.872787642407679*^9, 3.872787656046327*^9}, {
  3.872788895692417*^9, 3.872788932313096*^9}, {3.8727889780565233`*^9, 
  3.872788978424065*^9}, {3.872789530328937*^9, 3.872789540646806*^9}, {
  3.872789585296913*^9, 3.872789585445369*^9}, {3.8728409139186287`*^9, 
  3.872840916308522*^9}, {3.8728495678917017`*^9, 3.8728495738107967`*^9}},
 CellLabel->
  "In[889]:=",ExpressionUUID->"5ad911fb-cb63-4cd6-8551-e00eda2009e7"],

Cell[BoxData[
 TagBox[
  StyleBox["3.682931075780109`*^-19",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.8727889134417877`*^9, 3.872788932734542*^9}, 
   3.872788978921811*^9, {3.872789531877469*^9, 3.872789540987729*^9}, 
   3.872789585892194*^9, 3.8727951896750526`*^9, 3.872795940811214*^9, {
   3.8727959932405987`*^9, 3.872795997672605*^9}, 3.872796515757333*^9, 
   3.872796617173212*^9, 3.872797221217608*^9, 3.8728407316293573`*^9, 
   3.872840916619995*^9, 3.872848419036895*^9, 3.872850074580936*^9},
 CellLabel->
  "Out[889]//FullForm=",ExpressionUUID->"c029c9ea-f4e6-439d-8471-\
0143c207b5c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1528, 1227},
WindowMargins->{{65, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"54c036ee-18c9-4191-ad0e-0236061fd8ad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 244, 4, 98, "Title",ExpressionUUID->"86275ee3-51a6-4326-9f3f-6d593e344f16"],
Cell[CellGroupData[{
Cell[849, 30, 155, 3, 67, "Section",ExpressionUUID->"ee43f195-2845-4b78-b518-3718626c817c"],
Cell[CellGroupData[{
Cell[1029, 37, 213, 4, 54, "Subsection",ExpressionUUID->"d9e6781f-66d7-4dac-9d89-13fc93dcac69"],
Cell[1245, 43, 6041, 134, 430, "Input",ExpressionUUID->"5e3180d2-b40c-41e3-bc6c-dbd87624233b"],
Cell[7289, 179, 14103, 323, 1144, "Input",ExpressionUUID->"c02cd428-ff94-46cb-b4a8-72b7425ac0ad"],
Cell[21395, 504, 3708, 86, 178, "Input",ExpressionUUID->"044e38e6-e892-4255-8faf-f899242ea7e4"],
Cell[25106, 592, 1829, 46, 178, "Input",ExpressionUUID->"f2f29f27-6b3f-489b-999c-ac2141fde43e"],
Cell[26938, 640, 3837, 94, 199, "Input",ExpressionUUID->"8fc0f41c-220c-4f4d-a676-5cb01dadf168"],
Cell[30778, 736, 3277, 80, 178, "Input",ExpressionUUID->"efa2ea67-9a7a-46f0-b396-e9673921f7de"]
}, Closed]],
Cell[CellGroupData[{
Cell[34092, 821, 212, 4, 38, "Subsection",ExpressionUUID->"b547e410-9e2c-4456-861f-d45fbf921924"],
Cell[34307, 827, 187, 3, 35, "Text",ExpressionUUID->"1c3cef45-cff7-4d8d-9a51-8daf2400706d"],
Cell[CellGroupData[{
Cell[34519, 834, 1085, 26, 136, "Input",ExpressionUUID->"9b293a60-a18c-4749-a827-6648df9d9bdd"],
Cell[35607, 862, 2472, 53, 339, "Output",ExpressionUUID->"658ed01b-2281-44e1-9aab-85f81c7cced8"]
}, Open  ]],
Cell[38094, 918, 212, 4, 35, "Text",ExpressionUUID->"8dab4ed5-9c54-4b63-82c2-30b396990e47"],
Cell[38309, 924, 2452, 63, 157, "Input",ExpressionUUID->"5e8905ba-e0ba-4f61-a99a-92946633d8aa"],
Cell[40764, 989, 218, 4, 35, "Text",ExpressionUUID->"8a7814c2-e3f7-4f67-bb3b-8df187f51caa"],
Cell[CellGroupData[{
Cell[41007, 997, 1300, 30, 136, "Input",ExpressionUUID->"dad85e1c-c656-423a-96e8-581280783a74"],
Cell[42310, 1029, 2528, 53, 339, "Output",ExpressionUUID->"c1f3161b-f9cb-4f2a-81a4-a9986cd34309"]
}, Open  ]],
Cell[44853, 1085, 786, 18, 52, "Input",ExpressionUUID->"49b15741-31cb-482b-a0e7-77aad16b3b08"],
Cell[45642, 1105, 3854, 88, 325, "Input",ExpressionUUID->"9a7721cf-b407-4028-a561-705a1d3b3e7d"],
Cell[49499, 1195, 14399, 337, 1225, "Input",ExpressionUUID->"d7d5c4fa-906b-490b-9304-de4c4eb82c61"],
Cell[63901, 1534, 2041, 49, 115, "Input",ExpressionUUID->"2afffa21-7eff-4618-bcec-8671174e89fd"],
Cell[65945, 1585, 9426, 202, 797, "Input",ExpressionUUID->"f1131458-1a5c-4f05-b377-0ef70b087482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75408, 1792, 209, 4, 54, "Subsection",ExpressionUUID->"1b7bf3ee-c334-4f4a-8d79-ded55f8a87ba"],
Cell[75620, 1798, 1004, 27, 94, "Input",ExpressionUUID->"f42c563d-c88c-4337-8304-2aa82e081d5f"],
Cell[76627, 1827, 11883, 278, 682, "Input",ExpressionUUID->"675c1819-b02a-48b1-8c82-d56c04a3b187"],
Cell[CellGroupData[{
Cell[88535, 2109, 155, 3, 45, "Subsubsection",ExpressionUUID->"6036fe86-de95-4e7d-9eea-fb994010867b"],
Cell[CellGroupData[{
Cell[88715, 2116, 610, 16, 72, "Input",ExpressionUUID->"8ee3a4e9-3281-4870-bc18-df1221206d2e"],
Cell[CellGroupData[{
Cell[89350, 2136, 284, 6, 24, "Print",ExpressionUUID->"28aae435-6bc1-4674-941f-d5c56ea9799d"],
Cell[89637, 2144, 298, 6, 24, "Print",ExpressionUUID->"c8f381a9-cd44-46bb-ac7b-3162c39350d6"],
Cell[89938, 2152, 287, 6, 44, "Print",ExpressionUUID->"05a17ff0-c733-4f96-8be4-e98170a45efa"]
}, Open  ]]
}, Open  ]],
Cell[90252, 2162, 4308, 107, 311, "Input",ExpressionUUID->"2e97743c-c644-4685-a7b7-a591424bb0ea"],
Cell[94563, 2271, 521, 14, 30, "Input",ExpressionUUID->"3ede01d6-4b7f-4af1-9434-a851b5a5b538"]
}, Closed]],
Cell[CellGroupData[{
Cell[95121, 2290, 154, 3, 37, "Subsubsection",ExpressionUUID->"7ac64cef-cc72-40c3-b48c-68e35887e6a1"],
Cell[95278, 2295, 3891, 86, 295, "Input",ExpressionUUID->"5b02253c-359c-4203-8f27-7211fad6bb62"],
Cell[99172, 2383, 6566, 150, 457, "Input",ExpressionUUID->"efb2f9aa-632f-4dd7-bcce-6af3e3458c27"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105799, 2540, 201, 4, 67, "Section",ExpressionUUID->"ef225625-0b88-45fb-8fdb-f255a2a686c7"],
Cell[CellGroupData[{
Cell[106025, 2548, 251, 4, 54, "Subsection",ExpressionUUID->"a3e5066a-c60e-45ea-ac90-7db4e61b0b23"],
Cell[CellGroupData[{
Cell[106301, 2556, 175, 3, 45, "Subsubsection",ExpressionUUID->"796ffb14-c098-4ac3-84da-e0229f44bbc2"],
Cell[CellGroupData[{
Cell[106501, 2563, 1731, 40, 136, "Input",ExpressionUUID->"cfae60b0-1f28-4f0c-8a13-9b75b1b17ba3"],
Cell[108235, 2605, 4007, 85, 616, "Output",ExpressionUUID->"b02202c0-bf7b-477c-b0e6-cbac6869b005"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112279, 2695, 314, 7, 30, "Input",ExpressionUUID->"823f9611-eedf-4267-8323-717a4ed4877c"],
Cell[112596, 2704, 407, 11, 50, "Output",ExpressionUUID->"899f3a27-8505-4532-bb98-dff6d1267b61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113040, 2720, 263, 5, 30, "Input",ExpressionUUID->"46261589-eed9-491b-bb3f-3804b65678cd"],
Cell[113306, 2727, 482, 14, 52, "Output",ExpressionUUID->"1ee981d2-9e2e-4bf3-9b39-9f86790cf41b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113825, 2746, 357, 7, 30, "Input",ExpressionUUID->"529afaac-2080-4dd8-aafc-17946f138f6a"],
Cell[114185, 2755, 394, 9, 54, "Output",ExpressionUUID->"cb298848-d952-4600-b786-56a9769f2764"]
}, Open  ]],
Cell[114594, 2767, 357, 9, 30, "Input",ExpressionUUID->"86cd4bf9-d934-4f35-8aea-12eb3c46eca6"],
Cell[114954, 2778, 201, 3, 35, "Text",ExpressionUUID->"b77fddd6-10ce-4d11-85fb-1c160968703a"],
Cell[CellGroupData[{
Cell[115180, 2785, 338, 8, 30, "Input",ExpressionUUID->"8810b010-305d-49af-8542-2f71131288dc"],
Cell[115521, 2795, 10970, 323, 482, "Output",ExpressionUUID->"c33c8dcd-fed6-4792-b0c9-07ad91030f34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126528, 3123, 272, 6, 30, "Input",ExpressionUUID->"02bb3d73-9b06-4699-9eb0-c7cc08034c27"],
Cell[126803, 3131, 858, 16, 54, "Output",ExpressionUUID->"9bcd7b8f-c7b1-4260-bcf3-d83600464283"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127710, 3153, 175, 3, 37, "Subsubsection",ExpressionUUID->"e670d7b1-c56f-4158-aa20-2692927d337e"],
Cell[CellGroupData[{
Cell[127910, 3160, 1924, 45, 136, "Input",ExpressionUUID->"6f88a067-6c6b-4873-bbcf-eb2731b97e0c"],
Cell[129837, 3207, 4104, 87, 616, "Output",ExpressionUUID->"21915df4-be86-48cc-849c-5ead92f86716"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133978, 3299, 314, 7, 30, "Input",ExpressionUUID->"04741e17-dcc6-48b7-b7bc-eb73b15e0613"],
Cell[134295, 3308, 478, 12, 50, "Output",ExpressionUUID->"075ce8fd-e880-4c55-ac64-fc7b77ba1326"]
}, Open  ]],
Cell[134788, 3323, 380, 8, 30, "Input",ExpressionUUID->"0ff2b356-8ac2-4938-8e93-edbea8555cc5"],
Cell[CellGroupData[{
Cell[135193, 3335, 463, 10, 30, "Input",ExpressionUUID->"d6f89575-c604-43cd-a094-bcf4c17b272d"],
Cell[135659, 3347, 612, 16, 45, "Output",ExpressionUUID->"6298eb56-55db-4d05-8354-8850fffb152e"]
}, Open  ]],
Cell[136286, 3366, 357, 9, 30, "Input",ExpressionUUID->"f2511339-bd98-4cf1-baa8-5926c7a1c902"],
Cell[CellGroupData[{
Cell[136668, 3379, 379, 9, 30, "Input",ExpressionUUID->"6009c3a7-b9a1-42f8-991b-3d76e2ae2384"],
Cell[137050, 3390, 1105, 23, 45, "Output",ExpressionUUID->"6d51b615-36ac-489b-8897-fcd08e6af48d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[138204, 3419, 179, 3, 37, "Subsubsection",ExpressionUUID->"ae7c4cec-3d5a-4896-83c1-84bf2e4f7e1b"],
Cell[CellGroupData[{
Cell[138408, 3426, 2412, 55, 157, "Input",ExpressionUUID->"0f51cd45-fe5c-4882-a04c-7fb00de4bd49"],
Cell[140823, 3483, 8622, 185, 404, "Output",ExpressionUUID->"be6a9ee8-b966-4d61-8c81-ca9827b145c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149482, 3673, 314, 7, 30, "Input",ExpressionUUID->"4361f300-2f4c-45e2-bf10-e5127d8a827a"],
Cell[149799, 3682, 1658, 50, 50, "Output",ExpressionUUID->"16583879-d544-4c37-a7e4-ff4b31885054"]
}, Open  ]],
Cell[151472, 3735, 335, 7, 30, "Input",ExpressionUUID->"64462c33-6a32-40e8-ad26-217148f093f3"],
Cell[CellGroupData[{
Cell[151832, 3746, 565, 12, 30, "Input",ExpressionUUID->"3efc3722-2b15-4699-b8b6-25bb347dbf75"],
Cell[152400, 3760, 951, 21, 45, "Output",ExpressionUUID->"2130eada-f77f-4dc1-9b29-e4f984fcee8a"]
}, Open  ]],
Cell[153366, 3784, 409, 10, 30, "Input",ExpressionUUID->"5e4a8629-8c17-43d0-918d-d89c085e1031"],
Cell[CellGroupData[{
Cell[153800, 3798, 405, 9, 30, "Input",ExpressionUUID->"dddb162a-5393-4aa1-977a-d574c80b528c"],
Cell[154208, 3809, 636, 16, 45, "Output",ExpressionUUID->"bb747137-ad90-4052-9f6c-5da256a5ab24"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[154905, 3832, 353, 6, 38, "Subsection",ExpressionUUID->"f4fc9078-961d-4d4a-ac07-c31f0451b726"],
Cell[CellGroupData[{
Cell[155283, 3842, 175, 3, 45, "Subsubsection",ExpressionUUID->"8913c183-da1c-4fdb-a5e1-cb4225002846"],
Cell[CellGroupData[{
Cell[155483, 3849, 1383, 35, 146, "Input",ExpressionUUID->"8c49536e-7d08-442e-861e-fa6e567f40ed"],
Cell[156869, 3886, 3400, 76, 236, "Output",ExpressionUUID->"0129e826-8253-4226-8fa0-ea137edf0dcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160306, 3967, 422, 9, 42, "Input",ExpressionUUID->"03d498ac-2dc7-4928-bf90-e1c005530e8b"],
Cell[160731, 3978, 677, 19, 58, "Output",ExpressionUUID->"48ebd1c1-f1ff-4ee1-ad97-66870adca898"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161445, 4002, 421, 7, 42, "Input",ExpressionUUID->"24663029-3cfa-4912-beb3-ab5c4eb2544e"],
Cell[161869, 4011, 771, 24, 59, "Output",ExpressionUUID->"a4f3c0b3-5705-4693-88da-40da6c0ad069"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162677, 4040, 669, 13, 42, "Input",ExpressionUUID->"747718de-4696-4d6e-9770-9bf123c09a2c"],
Cell[163349, 4055, 330, 10, 46, "Output",ExpressionUUID->"e5ff18f3-a10e-4e96-a9ba-28f1463b5fbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163716, 4070, 486, 9, 42, "Input",ExpressionUUID->"8ca1db18-957d-492f-aa75-bccda27aa4c0"],
Cell[164205, 4081, 2043, 51, 108, "Output",ExpressionUUID->"951b40ad-d8e7-4a48-b9f1-e54f00bbc839"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166285, 4137, 521, 11, 42, "Input",ExpressionUUID->"8026b1ba-cf50-4526-9c9d-a86154158154"],
Cell[166809, 4150, 328, 10, 46, "Output",ExpressionUUID->"d694f363-d7f1-4f07-8497-031d14c68063"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[167198, 4167, 359, 6, 38, "Subsection",ExpressionUUID->"5560251c-5e10-46f1-86dd-7d8654fb5a27"],
Cell[CellGroupData[{
Cell[167582, 4177, 228, 4, 45, "Subsubsection",ExpressionUUID->"18aa0db7-cbde-4389-8b40-476fa13ef978"],
Cell[CellGroupData[{
Cell[167835, 4185, 1765, 44, 115, "Input",ExpressionUUID->"7df8cd5c-433d-4640-94c1-226ea79a638b"],
Cell[169603, 4231, 5132, 108, 502, "Output",ExpressionUUID->"03a33bc3-fe0e-4c39-b7b4-7f4b730cb906"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174772, 4344, 413, 7, 30, "Input",ExpressionUUID->"7b8c7e9a-75b6-4132-8fa6-6bc5344b5a8d"],
Cell[175188, 4353, 1847, 54, 60, "Output",ExpressionUUID->"7a6e5973-2e36-4a82-97f4-41f0dcd7c584"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177072, 4412, 252, 6, 30, "Input",ExpressionUUID->"39b04623-0359-416f-a7f4-848903b329dc"],
Cell[177327, 4420, 731, 20, 50, "Output",ExpressionUUID->"aa169cc6-1bc5-48db-8f59-49f271bacf9d"]
}, Open  ]],
Cell[178073, 4443, 438, 9, 30, "Input",ExpressionUUID->"acd24b9a-ee5e-42f7-b6a5-a8155cc26425"],
Cell[CellGroupData[{
Cell[178536, 4456, 667, 13, 30, "Input",ExpressionUUID->"4854823a-813f-4809-93a0-a03df0d40ffe"],
Cell[179206, 4471, 450, 13, 45, "Output",ExpressionUUID->"a0cddf38-38ed-45b4-92a3-983549a77a75"]
}, Open  ]],
Cell[179671, 4487, 509, 11, 30, "Input",ExpressionUUID->"893d6925-49b3-4166-9979-92918c1dc968"],
Cell[CellGroupData[{
Cell[180205, 4502, 665, 13, 30, "Input",ExpressionUUID->"48bd1a16-deed-4dcc-9ffe-a934e9a38ef3"],
Cell[180873, 4517, 500, 14, 45, "Output",ExpressionUUID->"e7794a14-d27f-4d49-b43c-6b7f766957d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181410, 4536, 956, 23, 73, "Input",ExpressionUUID->"c1b3346d-5369-43aa-81e9-bafc930dc865"],
Cell[CellGroupData[{
Cell[182391, 4563, 366, 6, 24, "Print",ExpressionUUID->"25735fc6-f7c4-4665-9472-89ba83775c81"],
Cell[182760, 4571, 384, 7, 24, "Print",ExpressionUUID->"fac4d0fe-5b7d-4213-ab10-97566beb177b"],
Cell[183147, 4580, 358, 6, 24, "Print",ExpressionUUID->"f81db64c-a187-4c50-988f-38356cebd7a3"],
Cell[183508, 4588, 3609, 71, 440, "Print",ExpressionUUID->"8b266d0a-8bfd-41f3-9ff5-e3f5fb6ca410"],
Cell[187120, 4661, 575, 13, 24, "Print",ExpressionUUID->"06aaedb2-d5ff-4a8b-abeb-d5ea3d1b2c25"],
Cell[187698, 4676, 612, 14, 24, "Print",ExpressionUUID->"042d3816-cfb2-4cc1-a20f-34be3d9a56ee"],
Cell[188313, 4692, 1046, 24, 37, "Print",ExpressionUUID->"2c547cbc-de3f-43d6-a852-8752f65ad114"],
Cell[189362, 4718, 533, 12, 24, "Print",ExpressionUUID->"b38e95c9-e719-4cd0-a695-7affff03904a"],
Cell[189898, 4732, 384, 7, 24, "Print",ExpressionUUID->"aff72103-b9c0-4d78-90a9-888a9c45b7e1"],
Cell[190285, 4741, 360, 6, 24, "Print",ExpressionUUID->"28e807dc-4269-45ad-a6ce-1376e9b31561"],
Cell[190648, 4749, 2167, 46, 133, "Print",ExpressionUUID->"35c1fae5-5e38-4e49-99bb-d60cbaf38545"],
Cell[192818, 4797, 578, 13, 24, "Print",ExpressionUUID->"84266333-6f74-4397-a57c-946f3a332b65"],
Cell[193399, 4812, 969, 25, 41, "Print",ExpressionUUID->"8125c515-5a48-4872-8eaa-54263f4888b1"],
Cell[194371, 4839, 386, 7, 24, "Print",ExpressionUUID->"b4e17478-6daa-4bb8-9590-e3bdc19520ac"]
}, Open  ]],
Cell[194772, 4849, 798, 22, 52, "Output",ExpressionUUID->"331ad853-6c18-436c-b0b2-2e3e1a21a3d9"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[195631, 4878, 310, 5, 38, "Subsection",ExpressionUUID->"1eb49525-a8c1-4c8b-a25a-526799bd79a8"],
Cell[CellGroupData[{
Cell[195966, 4887, 175, 3, 45, "Subsubsection",ExpressionUUID->"127a6db8-05e4-4129-8596-c63542174ac7"],
Cell[CellGroupData[{
Cell[196166, 4894, 1785, 41, 136, "Input",ExpressionUUID->"1e0219a9-bc2a-4449-8049-297308886fb3"],
Cell[197954, 4937, 5455, 114, 639, "Output",ExpressionUUID->"af4f9b81-982d-4ca9-802c-528e83afed66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203446, 5056, 385, 8, 30, "Input",ExpressionUUID->"ac03b746-84f0-4a66-8742-a04d76133c09"],
Cell[203834, 5066, 1815, 54, 63, "Output",ExpressionUUID->"f1401212-3bb8-4e71-9edb-9221b9cfb40e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205686, 5125, 389, 8, 30, "Input",ExpressionUUID->"b42db903-a0f0-410e-bed0-9e69f1e446e7"],
Cell[206078, 5135, 701, 19, 50, "Output",ExpressionUUID->"fb7cf2f9-a183-4fba-b1c7-a5d4068c33e8"]
}, Open  ]],
Cell[206794, 5157, 411, 9, 30, "Input",ExpressionUUID->"a62a1ff3-2bd3-40c0-8f2d-e216d7d253ae"],
Cell[CellGroupData[{
Cell[207230, 5170, 635, 12, 30, "Input",ExpressionUUID->"552c5c35-720b-4dfe-90ed-029c4c4bd6ec"],
Cell[207868, 5184, 398, 11, 45, "Output",ExpressionUUID->"41700dc6-7f1f-479c-98b4-1e2951b7b8ab"]
}, Open  ]],
Cell[208281, 5198, 481, 11, 30, "Input",ExpressionUUID->"b6985f63-a47a-4bd0-9b59-12cdcdc1089b"],
Cell[CellGroupData[{
Cell[208787, 5213, 500, 12, 30, "Input",ExpressionUUID->"2d140f4f-6d5a-438c-a858-91602cacc35c"],
Cell[209290, 5227, 374, 11, 45, "Output",ExpressionUUID->"c1898260-bc57-48f0-8c02-f4a4585112fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209701, 5243, 879, 22, 73, "Input",ExpressionUUID->"bb86d352-0ad4-4e55-8764-73ca666a1580"],
Cell[CellGroupData[{
Cell[210605, 5269, 668, 12, 24, "Print",ExpressionUUID->"a71adb68-5e55-4005-ab51-8b9c90d543b9"],
Cell[211276, 5283, 681, 12, 24, "Print",ExpressionUUID->"7bd1200a-cf37-4ec7-92eb-3b157db1ac12"],
Cell[211960, 5297, 653, 11, 24, "Print",ExpressionUUID->"f2cdaff8-0a1d-45a2-b2df-5695e3f5e56f"],
Cell[212616, 5310, 4349, 85, 440, "Print",ExpressionUUID->"7a48ff40-1776-427d-b246-977ed795e348"],
Cell[216968, 5397, 870, 18, 24, "Print",ExpressionUUID->"e0fa0aa4-2164-41b3-b811-101f7ac265a4"],
Cell[217841, 5417, 892, 19, 24, "Print",ExpressionUUID->"571d6b78-5b9d-4122-b2f1-b8bbd76e674e"],
Cell[218736, 5438, 1376, 30, 37, "Print",ExpressionUUID->"15bf748c-31ba-493e-beaa-104f28896355"],
Cell[220115, 5470, 817, 17, 24, "Print",ExpressionUUID->"5e28d82e-3a69-4e42-ae15-c6e15c6d7d49"],
Cell[220935, 5489, 681, 12, 24, "Print",ExpressionUUID->"1a8a24af-1879-4b19-b474-a660d99d749f"],
Cell[221619, 5503, 655, 11, 24, "Print",ExpressionUUID->"fc5bee27-005e-4a4f-94d6-684216af92a4"],
Cell[222277, 5516, 3664, 71, 440, "Print",ExpressionUUID->"7d677c2b-f26f-46d9-99f0-b40af0d57683"],
Cell[225944, 5589, 869, 18, 24, "Print",ExpressionUUID->"7ab87d1f-0307-4c33-8983-9be25f3c6efb"],
Cell[226816, 5609, 907, 19, 24, "Print",ExpressionUUID->"2e5bd53c-0f79-4d45-a5bd-78584edfdfb5"],
Cell[227726, 5630, 1339, 29, 37, "Print",ExpressionUUID->"b333c897-b05d-4007-b2ef-388bb81ed0ef"],
Cell[229068, 5661, 828, 17, 24, "Print",ExpressionUUID->"7a628427-093b-49da-a66e-98ec1eb89d28"],
Cell[229899, 5680, 679, 12, 24, "Print",ExpressionUUID->"f997bffb-d0d3-4131-bb13-9405e13e5391"],
Cell[230581, 5694, 653, 11, 24, "Print",ExpressionUUID->"8a309442-b49b-4fd9-ad3f-bd64b8eb2e4e"],
Cell[231237, 5707, 2458, 51, 133, "Print",ExpressionUUID->"534df56f-79a7-4c2b-b9b3-6b63a2508c82"],
Cell[233698, 5760, 871, 18, 24, "Print",ExpressionUUID->"893354e3-387b-47ce-b5c2-583120354fa8"],
Cell[234572, 5780, 1267, 30, 41, "Print",ExpressionUUID->"a62e2414-4a42-415e-be08-cb84063cd5cd"],
Cell[235842, 5812, 679, 12, 24, "Print",ExpressionUUID->"daa89537-989a-4e09-83c2-73605e01dadf"],
Cell[236524, 5826, 1453, 35, 41, "Print",ExpressionUUID->"8b617b2e-3176-450a-a945-18e817908ca9"],
Cell[237980, 5863, 678, 12, 24, "Print",ExpressionUUID->"fd788caf-e474-4a25-a306-fc1589031bff"]
}, Open  ]],
Cell[238673, 5878, 1270, 32, 52, "Output",ExpressionUUID->"54261746-ee08-424f-90f5-60a9ff0457dd"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[240004, 5917, 209, 4, 38, "Subsection",ExpressionUUID->"e6a620a0-e2f5-4f64-a657-2e55a61fa9c5"],
Cell[CellGroupData[{
Cell[240238, 5925, 230, 4, 45, "Subsubsection",ExpressionUUID->"53263628-3c39-4ec5-880b-55992f2b2424"],
Cell[CellGroupData[{
Cell[240493, 5933, 2040, 50, 178, "Input",ExpressionUUID->"89de0412-260e-47a7-911f-446cd7618cdc"],
Cell[242536, 5985, 6063, 132, 1327, "Output",ExpressionUUID->"ffd1ecaa-456d-4459-b4bc-c62746900a46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248636, 6122, 328, 7, 30, "Input",ExpressionUUID->"8e9a0ccf-d421-4f9a-9bf9-97d1d7735cc9"],
Cell[248967, 6131, 703, 19, 50, "Output",ExpressionUUID->"6b7d55ed-a50c-455b-bae7-70b77781c091"]
}, Open  ]],
Cell[249685, 6153, 367, 8, 30, "Input",ExpressionUUID->"ddb44adf-eefa-45ea-bc96-8a5bf5b37e35"],
Cell[CellGroupData[{
Cell[250077, 6165, 477, 10, 30, "Input",ExpressionUUID->"f074a865-04a2-40bb-9ad7-1ddf818e24a1"],
Cell[250557, 6177, 599, 15, 45, "Output",ExpressionUUID->"111fc611-fc81-4f66-8133-b85b4bb0b2c7"]
}, Open  ]],
Cell[251171, 6195, 473, 11, 30, "Input",ExpressionUUID->"a7376605-dfc0-4cf5-8426-69c44e2b45f9"],
Cell[CellGroupData[{
Cell[251669, 6210, 601, 13, 30, "Input",ExpressionUUID->"718fa2ae-e07a-4295-90f6-51bf65514204"],
Cell[252273, 6225, 671, 15, 45, "Output",ExpressionUUID->"97ca3e65-b67d-4603-821d-ce322f05b687"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[252993, 6246, 307, 5, 37, "Subsubsection",ExpressionUUID->"0f13eb4e-a956-4257-8996-2ed2d1b53fb9"],
Cell[CellGroupData[{
Cell[253325, 6255, 2559, 60, 199, "Input",ExpressionUUID->"c260b5ce-3986-475e-bc99-3a51fdfd0075"],
Cell[255887, 6317, 11653, 251, 672, "Output",ExpressionUUID->"cd92ff53-f0df-43c6-907a-ecd0169f874d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267577, 6573, 328, 7, 30, "Input",ExpressionUUID->"e1edfda4-0909-45c2-8ca3-0c98c87fc65c"],
Cell[267908, 6582, 1846, 56, 50, "Output",ExpressionUUID->"8f53a872-e68b-47eb-938b-04a7b2862517"]
}, Open  ]],
Cell[269769, 6641, 367, 8, 30, "Input",ExpressionUUID->"9796279d-b3b4-4668-a4a1-93299869aa78"],
Cell[CellGroupData[{
Cell[270161, 6653, 477, 10, 30, "Input",ExpressionUUID->"30d4b0d6-e80f-4380-b8bb-d3207cc9c560"],
Cell[270641, 6665, 622, 15, 45, "Output",ExpressionUUID->"8b042522-bbd6-4d92-bc00-04d1156c0e02"]
}, Open  ]],
Cell[271278, 6683, 473, 11, 30, "Input",ExpressionUUID->"8751a6b8-75e6-4a3f-a830-c9666b11708a"],
Cell[CellGroupData[{
Cell[271776, 6698, 601, 13, 30, "Input",ExpressionUUID->"b35aaf7d-8a73-4ee8-9804-1c0f98370738"],
Cell[272380, 6713, 693, 15, 45, "Output",ExpressionUUID->"93c9ad99-2ed9-4713-9568-39441ab07cae"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[273134, 6735, 255, 4, 38, "Subsection",ExpressionUUID->"ed563676-8a6d-4cbd-8886-1e86c9133a15"],
Cell[CellGroupData[{
Cell[273414, 6743, 280, 4, 45, "Subsubsection",ExpressionUUID->"e032fa89-33c8-4b87-9f40-9679a725a2e7"],
Cell[CellGroupData[{
Cell[273719, 6751, 3930, 93, 262, "Input",ExpressionUUID->"158eaf9c-dff7-40e7-b5ad-c350f1c581e7"],
Cell[277652, 6846, 9864, 188, 981, "Output",ExpressionUUID->"6ca1866b-965d-4391-9d45-47829fd212bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287553, 7039, 368, 8, 30, "Input",ExpressionUUID->"12c3530c-852d-4b6c-9fe6-7cb034748e71"],
Cell[287924, 7049, 2238, 68, 89, "Output",ExpressionUUID->"0eb2e65c-df9e-486a-a981-3e3a001a3232"]
}, Open  ]],
Cell[290177, 7120, 408, 9, 30, "Input",ExpressionUUID->"81182dd0-b90f-4111-8d1e-88bb6e9f273e"],
Cell[CellGroupData[{
Cell[290610, 7133, 520, 11, 30, "Input",ExpressionUUID->"2ef7f814-32a4-4209-a480-a7c51cd14b7c"],
Cell[291133, 7146, 622, 15, 45, "Output",ExpressionUUID->"a80badce-8cd1-480f-a77b-1d2411ef422f"]
}, Open  ]],
Cell[291770, 7164, 513, 11, 30, "Input",ExpressionUUID->"7acac116-a411-4d0c-a6a6-181025271d1f"],
Cell[CellGroupData[{
Cell[292308, 7179, 633, 12, 30, "Input",ExpressionUUID->"5ad911fb-cb63-4cd6-8551-e00eda2009e7"],
Cell[292944, 7193, 694, 15, 45, "Output",ExpressionUUID->"c029c9ea-f4e6-439d-8471-0143c207b5c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

